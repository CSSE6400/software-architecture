Last Updated on 2023/02/14     

<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>Layered Architecture</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- fn-in,html,htex4ht,xhtml --> 
<meta name="src" content="main.tex" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<link rel="stylesheet" href="https://latex.now.sh/style.css"> 
<style>body {max-width: 100ch;} 
dl dd {text-align: left}</style> 
</head><body 
>
   <div class="maketitle"><a 
 id="Q1-1-1"></a>
_________________________________________________________________________________________________
<h2 class="titleHead">Layered Architecture</h2>                                                 Software Architecture
   <div class="date" >February 20, 2023</div>                                                                          <div class="author" >Richard Thomas &amp; Brae
Webb</div>
______________________________________________________________________________________________
   </div>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 8--><p class="noindent" >In the beginning developers created the <span 
class="ecti-1200">big ball of mud</span>. It was without form and void, and darkness was over the face of
the developers<span class="footnote-mark"><a 
href="#fn1x0" id="fn1x0-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-1001f1"></a>.
The big ball of mud is an architectural style identified by it&#8217;s lack of architectural style <span class="cite">[<a 
href="#Xballofmud">1</a>]</span>. In a big ball of mud
architecture, all components of the system are allowed to communicate directly with each other. If the GUI
code wants data from the database, it will write an SQL query and send it to directly to the database.
Likewise, if the code which primarily talks to the database decides the GUI needs to be updated in a particular
way, it will do so.
</p><!--l. 16--><p class="indent" >   The ball of mud style is a challenging system to work under. Modifications can come from any direction at
any time. Akin to a program which primarily uses global variables, it is hard, if not impossible, to understand
everything that is happening or could happen.
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-1">    
<div class="tcolorbox-title">
<!--l. 27--><p class="indent" >   Aside</p></div> 
<div class="tcolorbox-content"><!--l. 27--><p class="noindent" >Code examples in these notes are works of fiction. Any resemblance to a working code is pure
coincidence. Having said that, python-esque syntax is often used for its brevity. We expect that
you can take away the important points from the code examples without getting distracted by
the details.  </p> 
</div> 
</div>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<div class="framedenv" id="code-1">
<!--l. 30--><pre class="listings" id="listing-1"><span class="label"><a 
 id="x1-1003r1"></a><span 
class="ecrm-0600">1</span></span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">gui</span></span> 
<span class="label"><a 
 id="x1-1004r2"></a><span 
class="ecrm-0600">2</span></span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">database</span></span> 
<span class="label"><a 
 id="x1-1005r3"></a></span> 
<span class="label"><a 
 id="x1-1006r4"></a><span 
class="ecrm-0600">4</span></span><span style="color:#000000"><span 
class="ectt-1200">button</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">gui</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">make_button</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Click</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">me</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">to</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">add</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">to</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">counter</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-1007r5"></a><span 
class="ecrm-0600">5</span></span><span style="color:#000000"><span 
class="ectt-1200">button</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">onclick</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">e</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=&#x003E;</span></span> 
<span class="label"><a 
 id="x1-1008r6"></a><span 
class="ecrm-0600">6</span></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">database</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">query</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">INSERT</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">INTO</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">clicks</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">time</span></span><span style="color:#669900"><span 
class="ectt-1200">)</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">VALUES</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">{{</span></span><span style="color:#669900"><span 
class="ectt-1200">e</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">time</span></span><span style="color:#669900"><span 
class="ectt-1200">}}</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-1009r7"></a><span 
class="ecrm-0600">7 </span></span></pre>
</div><a 
 id="x1-1010r1"></a>
<br />                                                                                                    <div class="caption" 
><span class="id">
Figure&#x00A0;1:  </span><span  
class="content">A  small  example  of  a  <span 
class="ecsl-1200">big  ball  of  mud  </span>architecture.  This  type  of  software  is  fine  for
experimentation but not for any code that has to be maintained. It also does not work well at scale.
</span></div><!--tex4ht:label?: x1-1010r1 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>Monolith Architecture</h3>
<!--l. 56--><p class="noindent" >And architects said, &#8220;let there be structure&#8221;, and developers saw that structure was good. And architects called the structure
<span 
class="ecti-1200">modularity</span><span class="footnote-mark"><a 
href="#fn2x0" id="fn2x0-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-2001f2"></a>.
</p><!--l. 61--><p class="indent" >   The monolithic software architecture is a single deployable application. There is a single code-base for the application
and all developers work within that code-base. An example monolith application would be one of the games developed by
<a 
href="https://my.uq.edu.au/programs-courses/course.html?course_code=DECO2800" >DECO2800</a><span class="footnote-mark"><a 
href="#fn3x0" id="fn3x0-bk"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-2003f3"></a>
students at <a 
href="https://www.uq.edu.au/" >UQ</a><span class="footnote-mark"><a 
href="#fn4x0" id="fn4x0-bk"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-2005f4"></a>.
(e.g. <a 
href="https://github.com/UQdeco2800/2021-studio-7" >Retroactive</a><span class="footnote-mark"><a 
href="#fn5x0" id="fn5x0-bk"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-2007f5"></a>).
A monolith should follow design conventions and be well structured and modular (i.e. it is not a big ball of
mud).
</p><!--l. 70--><p class="indent" >   Most developers are introduced to the monolith implicitly when they learn to program. They are told to
write a program, and it is a single executable application. This approach is fine, even preferred, for small
projects. It often becomes a problem for large, complex software systems.
</p><!--l. 75--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-30002.1"></a>Advantages</h4>
<!--l. 77--><p class="noindent" >The advantages of a monolith are that it is easy to develop, deploy and test. A single code-base means that all
developers know where to find all the source code for the project. They can use any IDE for development and
simple development tools can work with the code-base. There is no extra overhead that developers need to
learn to work on the system.
</p><!--l. 82--><p class="indent" >   Being a single executable component, deployment is as simple as copying the executable on to a computer
or server.
</p><!--l. 84--><p class="indent" >   System and integration testing tends to be easier with a monolith, as end-to-end tests are executing on a
single application. This often leads to easier debugging once errors are found in the software. All dependencies
and logic are within the application.
</p><!--l. 88--><p class="indent" >   There are also fewer issues to do with logging, exception handling, monitoring, and, to some extent,
scalability if it is running on a server.
</p><!--l. 91--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-40002.2"></a>Disadvantages</h4>
<!--l. 93--><p class="noindent" >The drawbacks of a monolith are complexity, coupling and scalability. Being a single application, as it gets
larger and more complex, there is more to understand. It becomes harder to know how to change existing
functionality or add new functionality without creating unexpected side effects. A catch phrase in software
design and architecture is to build complex systems, but not complicated systems. Monoliths can easily
become complicated as they grow to deliver complex behaviour.
</p><!--l. 99--><p class="indent" >   Related to complexity is coupling, with all behaviour implemented in one system there tends to be greater
dependency between different parts of the system. The more dependencies that exist, the more difficult it is to
understand any one part of the system. This means it is more difficult to make changes to the system or to
identify the cause of defects in the system.
</p><!--l. 104--><p class="indent" >   A monolith running on a server can be scaled by running it on multiple servers. Because it is a monolith,
without dependencies on other systems, it is easy to scale and replicate the system. The drawback is that you
have to replicate the entire system on another server. You cannot scale components of the system
                                                                                                    
                                                                                                    
independently of each other. If the persistence logic is creating a bottleneck, you have to copy the entire
application on to another server to scale the application. You cannot user servers that are optimised to
perform specialised tasks.
</p><!--l. 111--><p class="indent" >   Persistent state is a particular challenge when scaling a monolith. If the system is replicated on multiple
servers, the system has to be designed so that changes to the persistent data on one server does not invalidate
behaviour executing on another server.
</p><!--l. 117--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>Layered Architecture</h3>
<!--l. 119--><p class="noindent" >And architects said, &#8220;let there be an API between the components, and let it separate component from
component<span class="footnote-mark"><a 
href="#fn6x0" id="fn6x0-bk"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-5001f6"></a>&#8221;.
</p><!--l. 123--><p class="indent" >   The first architectural style we will investigate is a layered architecture. Layered architecture (also
called multi-tier or tiered architecture) partitions software into specialised clusters of components
(i.e. <span 
class="ecti-1200">layers</span>) and restricts how components in one layer can communicate with components in
another layer. A layered architecture creates superficial boundaries between the layers. Often
component boundaries are not enforced by the implementation technology but by architectural
policy.
</p><!--l. 130--><p class="indent" >   The creation of these boundaries provides the beginnings of some control over what your software is
allowed to do. Communication between the component boundaries is done via well-specified <span 
class="ecti-1200">contracts</span>. The use
of contracts results in each layer knowing precisely how it can be interacted with. Furthermore, when a layer
needs to be replaced or rewritten, it can be safely substituted with another layer fulfilling the
contract.
</p><!--l. 137--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-60003.1"></a>Standard Form</h4>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 148--><p class="noindent" ><object data="main-1.svg" width="182.94746 " height="150.88841 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-6001r2"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;2: </span><span  
class="content">The traditional specialised components of a layered architecture.
</span></div><!--tex4ht:label?: x1-6001r2 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 153--><p class="indent" >   The traditional components of a layered architecture are seen in Figure <a 
href="#x1-6001r2">2<!--tex4ht:ref: fig:traditional-layered --></a>. This style of layered architecture
is the four-tier architecture. Here, our system is composed of a presentation layer, business layer, persistence
layer, and database layer.
</p><!--l. 157--><p class="indent" >   The presentation layer takes data and formats it in a way that is sensible for humans. For command line
applications, the presentation layer would accept user input and print formatted messages for the user. For
traditional GUI applications, the presentation layer would use a GUI library to communicate with the
user.
</p><!--l. 161--><p class="indent" >   The business layer is the logic central to the application. The interface to the business layer is events or
queries triggered by the presentation layer. It is the responsibility of the business layer to determine the data
updates or queries required to fulfil the event or query.
</p><!--l. 165--><p class="indent" >   The persistence layer is essentially a wrapper over the database, allowing more abstract data updates or
queries to be made by the business layer. One advantage of the persistence layer is it enables the database to
be swapped out easily.
</p><!--l. 169--><p class="indent" >   Finally, the database layer is normally a commercial database application like MySQL, Postgres, etc. which
is populated with data specific to the software. Figure <a 
href="#x1-6008r3">3<!--tex4ht:ref: fig:standard-form-example --></a> is an over-engineered example of a layered
architecture.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 174--><p class="noindent" ></p><div class="framedenv" id="code-1">
<!--l. 174--><p class="noindent" ><tspan font-family="\ectt" font-size="\1200">» cat presentation.code</tspan> </p></div>    <div class="framedenv" id="code-1"><!--l. 174--><pre class="listings" id="listing-2"><span class="label"><a 
 id="x1-6002r1"></a><tspan font-family="\ecrm" font-size="\0600">1</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">gui</tspan></span> 
<span class="label"><a 
 id="x1-6003r2"></a><tspan font-family="\ecrm" font-size="\0600">2</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">business</tspan></span> 
<span class="label"><a 
 id="x1-6004r3"></a></span> 
<span class="label"><a 
 id="x1-6005r4"></a><tspan font-family="\ecrm" font-size="\0600">4</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">button</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">gui</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">make_button</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">Click</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">me</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">to</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">add</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">to</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">counter</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span> 
<span class="label"><a 
 id="x1-6006r5"></a><tspan font-family="\ecrm" font-size="\0600">5</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">button</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">onclick</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">business</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span>
 
<span class="label"><a 
 id="x1-6007r6"></a><tspan font-family="\ecrm" font-size="\0600">6 </tspan></span></pre>
</div><a 
 id="x1-6008r3"></a>
<br />                                                                                                    <div class="caption" 
><span class="id">
Figure&#x00A0;3: </span><span  
class="content">An unnecessarily complicated example of software components separated into the standard
layered form.
</span></div><!--tex4ht:label?: x1-6008r3 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 187--><p class="noindent" ></p><div class="framedenv" id="code-1">
<!--l. 187--><p class="noindent" ><tspan font-family="\ectt" font-size="\1200">» cat business.code</tspan> </p></div>    <div class="framedenv" id="code-1"><!--l. 187--><pre class="listings" id="listing-3"><span class="label"><a 
 id="x1-6009r1"></a><tspan font-family="\ecrm" font-size="\0600">1</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">persistence</tspan></span> 
<span class="label"><a 
 id="x1-6010r2"></a></span> 
<span class="label"><a 
 id="x1-6011r3"></a><tspan font-family="\ecrm" font-size="\0600">3</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">def</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">()</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-6012r4"></a><tspan font-family="\ecrm" font-size="\0600">4</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">persistence</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click_counts</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">add</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(1)</tspan></span>
 
<span class="label"><a 
 id="x1-6013r5"></a><tspan font-family="\ecrm" font-size="\0600">5 </tspan></span></pre>
</div>
<!--l. 194--><p class="noindent" ></p><div class="framedenv" id="code-1">
<!--l. 194--><p class="noindent" ><tspan font-family="\ectt" font-size="\1200">» cat persistence.code</tspan> </p></div>    <div class="framedenv" id="code-1"><!--l. 194--><pre class="listings" id="listing-4"><span class="label"><a 
 id="x1-6014r1"></a><tspan font-family="\ecrm" font-size="\0600">1</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">db</tspan></span> 
<span class="label"><a 
 id="x1-6015r2"></a></span> 
<span class="label"><a 
 id="x1-6016r3"></a><tspan font-family="\ecrm" font-size="\0600">3</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">class</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">ClickCounter</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-6017r4"></a><tspan font-family="\ecrm" font-size="\0600">4</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">clicks</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">0</tspan></span> 
<span class="label"><a 
 id="x1-6018r5"></a></span> 
<span class="label"><a 
 id="x1-6019r6"></a><tspan font-family="\ecrm" font-size="\0600">6</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">def</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">constructor</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">()</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-6020r7"></a><tspan font-family="\ecrm" font-size="\0600">7</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">clicks</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">db</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">query</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">SELECT</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">COUNT</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">(*)</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">FROM</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">clicks</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span> 
<span class="label"><a 
 id="x1-6021r8"></a></span> 
<span class="label"><a 
 id="x1-6022r9"></a><tspan font-family="\ecrm" font-size="\0600">9</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">def</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">get_click</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">()</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-6023r10"></a><tspan font-family="\ecrm" font-size="\0600">10</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">return</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">clicks</tspan></span> 
<span class="label"><a 
 id="x1-6024r11"></a></span> 
<span class="label"><a 
 id="x1-6025r12"></a><tspan font-family="\ecrm" font-size="\0600">12</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">def</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">add</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">amount</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-6026r13"></a><tspan font-family="\ecrm" font-size="\0600">13</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">db</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">query</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">INSERT</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">INTO</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">clicks</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">time</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">)</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">VALUES</tspan></span><span style="color:#669900"> </span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">{{</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">time</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">now</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">}}</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span> 
<span class="label"><a 
 id="x1-6027r14"></a></span> 
<span class="label"><a 
 id="x1-6028r15"></a><tspan font-family="\ecrm" font-size="\0600">15</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click_counts</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">ClickCounter</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">()</tspan></span>
 
<span class="label"><a 
 id="x1-6029r16"></a><tspan font-family="\ecrm" font-size="\0600">16 </tspan></span></pre>
</div><a 
 id="x1-6030r3"></a>
<br />                                                                                                    <div class="caption" 
><span class="id">
Figure&#x00A0;3: </span><span  
class="content">An unnecessarily complicated example of software components separated into the standard
layered form.
</span></div><!--tex4ht:label?: x1-6030r3 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 214--><p class="indent" >   One of the key benefits afforded by a well designed layered architecture is each layer should be
interchangeable. An example is an application which starts as a command line application, but can later be
adapted to a GUI application by just replacing the presentation layer.
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-70003.2"></a>Deployment Variations</h4>
<!--l. 220--><p class="noindent" >While the layered architecture is popular with software deployed on one machine (a non-distributed system),
layered architectures are also often deployed to separate machines.
</p><!--l. 223--><p class="indent" >   Each layer can be deployed as separate binaries on separate machines. A simple, common variant of
distributed deployment is separating the database layer, as shown in figure <a 
href="#x1-7001r4">4<!--tex4ht:ref: fig:layered-db-separated --></a>. Since databases have well defined
contracts and are language independent, the database layer is a natural first choice for physical
separation.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 241--><p class="noindent" ><object data="main-2.svg" width="182.94746 " height="169.85686 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-7001r4"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;4: </span><span  
class="content">Traditional layered architecture with a separately deployed database.
</span></div><!--tex4ht:label?: x1-7001r4 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 246--><p class="indent" >   In a well designed system, any layer of the system could be physically separated with minimal difficulty.
The presentation layer is another common target, as shown in figure <a 
href="#x1-7002r5">5<!--tex4ht:ref: fig:layered-db-pres-separated --></a>. Physically separating the presentation
layer gives users the ability to only install the presentation layer and allow communication to other software
components to occur via network communication.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 265--><p class="noindent" ><object data="main-3.svg" width="182.94746 " height="188.82529 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-7002r5"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;5: </span><span  
class="content">Traditional layered architecture with a separately deployed database and presentation layer.
</span></div><!--tex4ht:label?: x1-7002r5 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 270--><p class="indent" >   This deployment form is very typical of web applications. The presentation layer is deployed as a
HTML/JavaScript application which makes network requests to the remote business layer. The business layer
then validates requests and makes any appropriate data updates.
</p><!--l. 274--><p class="indent" >   Some database driven appliation generators will embedded the application logic in the database code so
that all logic runs on the database server. The presentation layer is then separated from the application logic,
as shown in figure <a 
href="#x1-7003r6">6<!--tex4ht:ref: fig:layered-pres-separated --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 291--><p class="noindent" ><object data="main-4.svg" width="182.94746 " height="169.85686 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-7003r6"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;6: </span><span  
class="content">Traditional layered architecture with a separately deployed presentation layer.
</span></div><!--tex4ht:label?: x1-7003r6 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
                                                                                                    
                                                                                                    
<!--l. 297--><p class="indent" >   An uncommon deployment variation (figure <a 
href="#x1-7006r7">7<!--tex4ht:ref: fig:uncommon-diagram --></a>) separates the presentation and business layers from the
persistence and database layers. An updated version of our running example is given in figure&#x00A0;<a 
href="#x1-7030r8">8<!--tex4ht:ref: fig:uncommon-code --></a>, the presentation
layer remains the same but the communication between the business and persistence layers is now via
REST.<span class="footnote-mark"><a 
href="#fn7x0" id="fn7x0-bk"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-7004f7"></a>
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 315--><p class="noindent" ><object data="main-5.svg" width="316.28029 " height="169.85683 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-7006r7"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;7: </span><span  
class="content">A contrived example of a deployment variation.
</span></div><!--tex4ht:label?: x1-7006r7 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 321--><p class="noindent" ></p><div class="framedenv" id="code-1">
<!--l. 321--><p class="noindent" ><tspan font-family="\ectt" font-size="\1200">» cat business.code</tspan> </p></div>    <div class="framedenv" id="code-1"><!--l. 321--><pre class="listings" id="listing-5"><span class="label"><a 
 id="x1-7007r1"></a><tspan font-family="\ecrm" font-size="\0600">1</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">http</tspan></span> 
<span class="label"><a 
 id="x1-7008r2"></a></span> 
<span class="label"><a 
 id="x1-7009r3"></a><tspan font-family="\ecrm" font-size="\0600">3</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">def</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">()</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-7010r4"></a><tspan font-family="\ecrm" font-size="\0600">4</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">http</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">post</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span> 
<span class="label"><a 
 id="x1-7011r5"></a><tspan font-family="\ecrm" font-size="\0600">5</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">address</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">192.168.0.40</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">,</tspan></span> 
<span class="label"><a 
 id="x1-7012r6"></a><tspan font-family="\ecrm" font-size="\0600">6</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">endpoint</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">/</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">click</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">/</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">add</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">,</tspan></span> 
<span class="label"><a 
 id="x1-7013r7"></a><tspan font-family="\ecrm" font-size="\0600">7</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">payload</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=1</tspan></span> 
<span class="label"><a 
 id="x1-7014r8"></a><tspan font-family="\ecrm" font-size="\0600">8</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span>
 
<span class="label"><a 
 id="x1-7015r9"></a><tspan font-family="\ecrm" font-size="\0600">9 </tspan></span></pre>
</div>
<!--l. 332--><p class="noindent" ></p><div class="framedenv" id="code-1">
<!--l. 332--><p class="noindent" ><tspan font-family="\ectt" font-size="\1200">» cat persistence.code</tspan> </p></div>    <div class="framedenv" id="code-1"><!--l. 332--><pre class="listings" id="listing-6"><span class="label"><a 
 id="x1-7016r1"></a><tspan font-family="\ecrm" font-size="\0600">1</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">db</tspan></span> 
<span class="label"><a 
 id="x1-7017r2"></a><tspan font-family="\ecrm" font-size="\0600">2</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">import</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">http</tspan></span> 
<span class="label"><a 
 id="x1-7018r3"></a></span> 
<span class="label"><a 
 id="x1-7019r4"></a><tspan font-family="\ecrm" font-size="\0600">4</tspan></span><span style="color:#006699"><tspan font-family="\ectt" font-size="\1200">class</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">ClickCounter</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">:</tspan></span> 
<span class="label"><a 
 id="x1-7020r5"></a><tspan font-family="\ecrm" font-size="\0600">5</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">...</tspan></span><span style="color:#000000"> </span><span style="color:#33997E"><tspan font-family="\ectt" font-size="\1200">#</tspan></span><span style="color:#33997E"> </span><span style="color:#33997E"><tspan font-family="\ectt" font-size="\1200">as</tspan></span><span style="color:#33997E"> </span><span style="color:#33997E"><tspan font-family="\ectt" font-size="\1200">above</tspan></span> 
<span class="label"><a 
 id="x1-7021r6"></a></span> 
<span class="label"><a 
 id="x1-7022r7"></a><tspan font-family="\ecrm" font-size="\0600">7</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click_counts</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">ClickCounter</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">()</tspan></span> 
<span class="label"><a 
 id="x1-7023r8"></a></span> 
<span class="label"><a 
 id="x1-7024r9"></a><tspan font-family="\ecrm" font-size="\0600">9</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">http</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">on</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span> 
<span class="label"><a 
 id="x1-7025r10"></a><tspan font-family="\ecrm" font-size="\0600">10</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">method</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">post</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">,</tspan></span> 
<span class="label"><a 
 id="x1-7026r11"></a><tspan font-family="\ecrm" font-size="\0600">11</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">endpoint</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">/</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">click</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">/</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">add</tspan></span><span style="color:#669900"><tspan font-family="\ectt" font-size="\1200">"</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">,</tspan></span> 
<span class="label"><a 
 id="x1-7027r12"></a><tspan font-family="\ecrm" font-size="\0600">12</tspan></span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">action</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=(</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">payload</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">=&#x003E;</tspan></span><span style="color:#000000"> </span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">click_counts</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">.</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">add</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">(</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">payload</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span> 
<span class="label"><a 
 id="x1-7028r13"></a><tspan font-family="\ecrm" font-size="\0600">13</tspan></span><span style="color:#000000"><tspan font-family="\ectt" font-size="\1200">)</tspan></span>
 
<span class="label"><a 
 id="x1-7029r14"></a><tspan font-family="\ecrm" font-size="\0600">14 </tspan></span></pre>
</div><a 
 id="x1-7030r8"></a>
<br />                                                                                                    <div class="caption" 
><span class="id">
Figure&#x00A0;8: </span><span  
class="content">Code adapted for the contrived example of a deployment variation.
</span></div><!--tex4ht:label?: x1-7030r8 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-80003.3"></a>Layered Principles</h4>
<!--l. 353--><p class="noindent" >Separating software into layers is intended to increase the modularity and isolation of the components within
each layer. Isolation is provided by defining a public interface through which all communication with the layer
is to be performed.
<a 
 id="x1-8001r1"></a>
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-2">    
<div class="tcolorbox-title">
   </div> 
<div class="tcolorbox-content"><!--l. 356--><p class="noindent" ><tspan font-family="\ecbx" font-size="\1200">Definition</tspan><tspan font-family="\ecbx" font-size="\1200">&#x00A0;1. Layer Isolation Principle</tspan>
</p><!--l. 357--><p class="noindent" >Layers  should  not  depend  on  implementation  details  of  another  layer.  Layers  should  only
communicate through well defined interfaces (<tspan font-family="\ecti" font-size="\1200">contracts</tspan>). </p> 
</div> 
</div>
<!--l. 361--><p class="indent" >   Layering should be enforced. One layer should not &#8220;reach across&#8221; another layer to access behaviour
implemented in some other layer. For example, in our standard form of the layered architecture, if the
presentation layer uses a component from the presistence layer, it defeats the intent of having a business layer
in the architecture.
</p><!--l. 365--><p class="indent" >   A consequence of this is chains of message passing. An extreme example would be if the presentation layer
needed to display some information from the database, the presentation layer would send a message to the
business layer to get the object to be displayed. The business layer would send a message to the persistence
layer to retrieve the object. The persistence layer would then send a message to the database layer to load the
object.
</p><!--l. 371--><p class="indent" >   Typically, there would not be a need to send messages from the highest to lowest layer. If the
business layer knew it had an up-to-date copy of the object, it would return it to the presentation
layer without messaging the persistence layer. If the persistence layer had already retrieved the
object from the database, it would return it to the business layer without messaging the database
layer.
<a 
 id="x1-8002r2"></a>
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-3">    
<div class="tcolorbox-title">
   </div> 
<div class="tcolorbox-content"><!--l. 375--><p class="noindent" ><tspan font-family="\ecbx" font-size="\1200">Definition</tspan><tspan font-family="\ecbx" font-size="\1200">&#x00A0;2. Neighbour Communication Principle</tspan>
</p><!--l. 376--><p class="noindent" >Components can communicate across layers only through directly neighbouring layers. </p> 
</div> 
</div>
<!--l. 379--><p class="indent" >   Layers should be hierarchical. Higher layers depend on services provided by lower layers but not vice versa.
This dependency is only through a public interface, so that components in the lower layer may be replaced by
another component implementing the same interface. Components in a lower layer should not use components
from a higher layer, even if the layers are neighbours.
<a 
 id="x1-8003r3"></a>
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-4">    
<div class="tcolorbox-title">
   </div> 
<div class="tcolorbox-content"><!--l. 383--><p class="noindent" ><tspan font-family="\ecbx" font-size="\1200">Definition</tspan><tspan font-family="\ecbx" font-size="\1200">&#x00A0;3. Downward Dependency Principle</tspan>
</p><!--l. 384--><p class="noindent" >Higher-level layers depend on lower layers, but lower-level layers do not depend on higher layers.
</p> 
</div> 
</div>
<!--l. 387--><p class="indent" >   Downward dependency does not mean that data is not passed to higher layers. It does not
even mean that control cannot flow from a lower level to a higher level. The restriction is on
dependencies or usage, not on data or control flow. A lower layer should not use components
from a higher layer, even through the higher layer&#8217;s interface. Breaking this increases the overall
coupling of the system and means it is no longer possible to replace a lower layer with another
layer.
</p><!--l. 393--><p class="indent" >   Lower layers need a mechanism to be able to notify a higher layer that something has happened, of which
the higher layer needs to be aware. A common example of this is the presentation layer wants to
                                                                                                    
                                                                                                    
be notified if data that it is displaying has been updated in a lower layer. The <a 
href="https://refactoring.guru/design-patterns/observer" >observer design
pattern</a><span class="footnote-mark"><a 
href="#fn8x0" id="fn8x0-bk"><sup class="textsuperscript">8</sup></a></span><a 
 id="x1-8004f8"></a>
is a common solution to this notification issue. The component responsible for displaying the data in the
presentation layer implements the <tspan font-family="\ecti" font-size="\1200">Observer </tspan>interface. The object containing data that may be updated
implements the <tspan font-family="\ecti" font-size="\1200">Subject </tspan>interface. The subject and observer interfaces are general purpose interfaces that do
not belong to the presentation layer. The lower layer uses the observer interface to notify the presentation layer
that data has changed and the presentation layer can decide whether to retrieve the new data and display it.
This allows the higher layer to be notified of events, without the lower layer using anything from the higher
layer.
</p><!--l. 403--><p class="indent" >   The same issue occurs with error handling and asynchronous messaging. If a component in a higher layer
sends a message, through an interface, to a component in a lower layer, the component in the lower layer needs
a mechanism to report errors. A simple boolean or error code return may work in some situations, but
often that is not appropriate. If the message is meant to return a value, in most languages it
cannot also return an error result. There may also be different types of errors that need to be
communicated to the higher layer. (e.g. The call from the higher layer broke the contract specified in the
interface. Or, the lower layer is encountering a transient fault and the higher layer should try again
later.) Exception handling works, if all layers are within one executable environment, but a key
purpose of a layered architecture is to allow separation of the layers, so throwing an exception is not
appropriate.
</p><!--l. 415--><p class="indent" >   <a 
href="https://www.codefellows.org/blog/what-is-a-callback-anyway/" >Callbacks</a><span class="footnote-mark"><a 
href="#fn9x0" id="fn9x0-bk"><sup class="textsuperscript">9</sup></a></span><a 
 id="x1-8006f9"></a>
are used to deal with this issue for both error handling and asynchronous messaging. A component from a
higher layer in the architecture passes a function as a parameter when it sends a message to a component in a
lower layer. This function is called by the component in the lower layer of the architecture to report an error or
to indicate that an asynchronous call has completed.
<a 
 id="x1-8008r4"></a>
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-5">    
<div class="tcolorbox-title">
   </div> 
<div class="tcolorbox-content"><!--l. 421--><p class="noindent" ><tspan font-family="\ecbx" font-size="\1200">Definition</tspan><tspan font-family="\ecbx" font-size="\1200">&#x00A0;4. Upward Notification Principle</tspan>
</p><!--l. 422--><p class="noindent" >Lower layers communicate with higher layers using general interfaces, callbacks and/or events.
Dependencies  are  minimised  by  not  relying  on  specific  details  published  in  a  higher  layer&#8217;s
interface. </p> 
</div> 
</div>
<!--l. 426--><p class="indent" >   The subject and observer interfaces are examples of supporting logical infrastructure. Logging framworks
are another example of supporting infrastructure. Commonly, all layers will need to use the logging framework.
These are typically defined in separate &#8220;layers&#8221; that can be used by any of the other layers. These are
sometimes called <tspan font-family="\ecti" font-size="\1200">sidecar </tspan>or acquaintance layers, as visually they are often drawn on the side of the layered
diagram.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<div class="center" 
>
<!--l. 433--><p class="noindent" >
</p><!--l. 434--><p class="noindent" ><img 
src="images/layered_with_sidecar.png" alt="PIC"  
width="173" height="173"  /></p></div>
<a 
 id="x1-8009r9"></a>
<br />                                                                                                    <div class="caption" 
><span class="id">
Figure&#x00A0;9: </span><span  
class="content">Layered architecture with sidecar.
</span></div><!--tex4ht:label?: x1-8009r9 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<a 
 id="x1-8010r5"></a>
   <div class="tcolorbox tcolorbox" id="tcolobox-6">    
<div class="tcolorbox-title">
   </div> 
<div class="tcolorbox-content"><!--l. 439--><p class="noindent" ><tspan font-family="\ecbx" font-size="\1200">Definition</tspan><tspan font-family="\ecbx" font-size="\1200">&#x00A0;5. Sidecar Spanning Principle</tspan>
</p><!--l. 440--><p class="noindent" >A sidecar layer contains interfaces that support complex communication between layers (e.g.
design patterns like the observer pattern) or external services (e.g. a logging framework). </p> 
</div> 
</div>
<!--l. 444--><p class="indent" >   A purist design approach says that a sidecar layer may only contain interfaces. In some
environments, an architecture may decide that multiple sidecars are beneficial, and may even use
these for reusable components from broader organisational systems or for objects that hold data
passed to higher layers. Figure <a 
href="#x1-8013r10">10<!--tex4ht:ref: fig:sidecar2 --></a> is an example of using sidecars for both of these purposes in a
<a 
href="https://www.oracle.com/java/technologies/appmodel.html" >J2EE</a><span class="footnote-mark"><a 
href="#fn10x0" id="fn10x0-bk"><sup class="textsuperscript">10</sup></a></span><a 
 id="x1-8011f10"></a>
application.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<div class="center" 
>
<!--l. 452--><p class="noindent" >
</p><!--l. 453--><p class="noindent" ><img 
src="images/layered_with_multiple_sidecars.png" alt="PIC"  
width="393" height="394"  /></p></div>
<a 
 id="x1-8013r10"></a>
<br />                                                                                                    <div class="caption" 
><span class="id">
Figure&#x00A0;10: </span><span  
class="content">Layered architecture with sidecars delivering implementation (figure 2.27 in Clements et al,
2010) <span class="cite">[<a 
href="#Xclements2010documenting">2</a>]</span>.
</span></div><!--tex4ht:label?: x1-8013r10 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 459--><p class="indent" >   In the example shown in figure <a 
href="#x1-8013r10">10<!--tex4ht:ref: fig:sidecar2 --></a>, the servlets and action classes layer is equivalent to the presentation
layer. The controller and service classes layers are a further partitioning of the business layer. The DAO
(Data Access Objects) classes layer is equivalent to the persistence layer. The database layer is not
shown in this example, which is common practice to hide it in diagrams focussing on the system&#8217;s
architecture.
</p><!--l. 465--><p class="indent" >   The Presentation DTOs (Data Transfer Objects) sidecar contains simple
<a 
href="https://www.educative.io/edpresso/why-use-javabean" >JavaBeans</a><span class="footnote-mark"><a 
href="#fn11x0" id="fn11x0-bk"><sup class="textsuperscript">11</sup></a></span><a 
 id="x1-8014f11"></a>
that contain data that is to be displayed. This approach takes advantage of J2EE&#8217;s mechanism that
automatically populates and updates data in the presentation layer.
</p><!--l. 469--><p class="indent" >   The Corporate DTOs and POJOs (Plain Old Java Objects) sidecar contains classes implemented by
corporate-wide systems, and which are shared between systems. These provide common data and behaviour
that spans multiple layers in many systems.
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">3.3.1   </span> <a 
 id="x1-90003.3.1"></a>Closed/Open Layers</h5>
<!--l. 475--><p class="noindent" >Some textbooks discuss the concept of closed and open layers. This is a way to describe how communication
flows between layers. Layers are categorised as either <tspan font-family="\ecsl" font-size="\1200">open </tspan>or <tspan font-family="\ecsl" font-size="\1200">closed</tspan>. By default layers are <tspan font-family="\ecsl" font-size="\1200">closed</tspan>. Closed
layers prevent direct communication between their adjacent layers, i.e. they enforce the neighbour
communication principle. Figure <a 
href="#x1-9001r11">11<!--tex4ht:ref: fig:closed-layers --></a> shows the communication channels (as arrows) in a completely closed
architecture.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 495--><p class="noindent" ><object data="main-6.svg" width="316.28029 " height="150.88841 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-9001r11"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;11: </span><span  
class="content">All layers closed requiring communication to pass through every layer.
</span></div><!--tex4ht:label?: x1-9001r11 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 500--><p class="indent" >   An architecture where all layers are closed provides maximum isolation. A change to the communication
contracts of any layer will require changes to at most one other layer.
</p><!--l. 503--><p class="indent" >   Some architects will advocate that there are some situations where an <tspan font-family="\ecsl" font-size="\1200">open </tspan>layer may be
useful. Open layers do not require communication to pass through the layer, other layers can
&#8220;reach across&#8221; the layer. The preferred approach is to use general interfaces, callbacks and/or
events, as discussed in the sections describing the downward dependency, upward notification,
and sidecar spanning principles. This provides mechanisms that allow data and control to flow
both up and down in a layered architecture, without breaking the isolation principle that was
the original intent of using a layered architecture. Open layers in architecture design should be
avoided.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 528--><p class="noindent" ><object data="main-7.svg" width="316.28029 " height="150.88841 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object> <a 
 id="x1-9002r12"></a>
<br />                                                                                                    </p><div class="caption" 
><span class="id">
Figure&#x00A0;12: </span><span  
class="content">A wolf in layer&#8217;s clothing <span class="cite">[<a 
href="#Xbass2013software">3</a>]</span>.
</span></div><!--tex4ht:label?: x1-9002r12 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-100003.4"></a>Advantages</h4>
<!--l. 534--><p class="noindent" >The layer isolation principle means that the implementation of a layer can be changed without affecting any
other layer, as long as the interface does not change.
</p><!--l. 537--><p class="indent" >   The layer isolation principle also means that a developer only needs to understand the public interface to
use a layer, and not its implementation details.
</p><!--l. 539--><p class="indent" >   The neighbour communication and downward dependency principles mean that if a layer changes its public
interface, at most one other layer needs to change.
</p><!--l. 541--><p class="indent" >   The upward notification and sidecar spanning principles mean that complex systems, with sophisticated
flows of control and data, can be implemented while maintaining the other layered architecture design
principles.
</p><!--l. 544--><p class="indent" >   Lower layers in the architecture can be designed to deliver common services that may be reused across
multiple applications. (e.g. The persistence layer can be designed to allow general purpose access to the
database layer, allowing any type of database to be substituted into the system.)
</p><!--l. 547--><p class="indent" >   Layers may be deployed on different computing infrastructure. This enables the hardware to be optimised
for the types of services provided by just one layer. It also enables scaling and replication by allowing layers to
be duplicated across multiple servers.
</p><!--l. 550--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-110003.5"></a>Disadvantages</h4>
<!--l. 551--><p class="noindent" >Poorly designed layers will encourage developers to break the layered architecture design principles in order to
get the system to work. This can lead to a system that in detail more closely resembles a big ball of mud, than
a layered design.
</p><!--l. 554--><p class="indent" >   Layering often introduces performance penalties. Requiring a chain of message passing to obtain a service
from a lower layer in the architecture adds to the cost of delivering the behaviour.
</p><!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-12000"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xballofmud"></a>B.&#x00A0;Foote  and  J.&#x00A0;Yoder,  &#8220;Big  ball  of  mud,&#8221;  <tspan font-family="\ecti" font-size="\1200">Pattern  languages  of  program  design</tspan>,  vol.&#x00A0;4,
   pp.&#x00A0;654&#8211;692, 1997.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xclements2010documenting"></a>D.&#x00A0;Garlan,  F.&#x00A0;Bachmann,  J.&#x00A0;Ivers,  J.&#x00A0;Stafford,  L.&#x00A0;Bass,  P.&#x00A0;Clements,  and  P.&#x00A0;Merson,
   <tspan font-family="\ecti" font-size="\1200">Documenting Software Architectures: Views and Beyond</tspan>.  Addison-Wesley Professional, 2nd&#x00A0;ed.,
   2010.
   </p>
                                                                                                    
                                                                                                    
   <p class="bibitem" ><span class="biblabel">
 [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbass2013software"></a>L.&#x00A0;Bass,  P.&#x00A0;Clements,  and  R.&#x00A0;Kazman,  <tspan font-family="\ecti" font-size="\1200">Software Architecture in Practice</tspan>.   Addison-Wesley
   Professional, 3rd&#x00A0;ed., September 2012.
</p>
   </div>
   <div class="footnotes"><a 
 id="x1-1002x1"></a>
<!--l. 10--><p class="indent" >     <span class="footnote-mark"><a 
href="#fn1x0-bk" id="fn1x0"><sup class="textsuperscript">1</sup></a></span><tspan font-family="\ecrm" font-size="\1000">Liberties taken from </tspan><a 
href="https://www.biblegateway.com/passage/?search=gen+1&version=ESV" ><tspan font-family="\ecrm" font-size="\1000">Genesis 1:1-2</tspan></a><tspan font-family="\ecrm" font-size="\1000">.</tspan></p><a 
 id="x1-2002x2"></a>
<!--l. 59--><p class="indent" >     <span class="footnote-mark"><a 
href="#fn2x0-bk" id="fn2x0"><sup class="textsuperscript">2</sup></a></span><tspan font-family="\ecrm" font-size="\1000">Liberties taken from </tspan><a 
href="https://www.biblegateway.com/passage/?search=gen+1&version=ESV" ><tspan font-family="\ecrm" font-size="\1000">Genesis 1:3-5</tspan></a><tspan font-family="\ecrm" font-size="\1000">.</tspan></p><a 
 id="x1-2004x2"></a>
<!--l. 64--><p class="indent" >     <span class="footnote-mark"><a 
href="#fn3x0-bk" id="fn3x0"><sup class="textsuperscript">3</sup></a></span>    <a 
href="https://my.uq.edu.au/programs-courses/course.html?course_code=DECO2800" class="url" ><tspan font-family="\ectt" font-size="\1000">https://my.uq.edu.au/programs-courses/course.html?course_code=DECO2800</tspan></a></p><a 
 id="x1-2006x2"></a>
<!--l. 65--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn4x0-bk" id="fn4x0"><sup class="textsuperscript">4</sup></a></span>    <a 
href="https://www.uq.edu.au/" class="url" ><tspan font-family="\ectt" font-size="\1000">https://www.uq.edu.au/</tspan></a></p><a 
 id="x1-2008x2"></a>
<!--l. 66--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn5x0-bk" id="fn5x0"><sup class="textsuperscript">5</sup></a></span>    <a 
href="https://github.com/UQdeco2800/2021-studio-7" class="url" ><tspan font-family="\ectt" font-size="\1000">https://github.com/UQdeco2800/2021-studio-7</tspan></a></p><a 
 id="x1-5002x3"></a>
<!--l. 121--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn6x0-bk" id="fn6x0"><sup class="textsuperscript">6</sup></a></span><tspan font-family="\ecrm" font-size="\1000">Liberties taken from </tspan><a 
href="https://www.biblegateway.com/passage/?search=gen+1&version=ESV" ><tspan font-family="\ecrm" font-size="\1000">Genesis 1:6-8</tspan></a><tspan font-family="\ecrm" font-size="\1000">.</tspan></p><a 
 id="x1-7005x3.2"></a>
<!--l. 301--><p class="indent" >     <span class="footnote-mark"><a 
href="#fn7x0-bk" id="fn7x0"><sup class="textsuperscript">7</sup></a></span>    <a 
href="https://restfulapi.net/" class="url" ><tspan font-family="\ectt" font-size="\1000">https://restfulapi.net/</tspan></a></p><a 
 id="x1-8005x3.3"></a>
<!--l. 395--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn8x0-bk" id="fn8x0"><sup class="textsuperscript">8</sup></a></span>    <a 
href="https://refactoring.guru/design-patterns/observer" class="url" ><tspan font-family="\ectt" font-size="\1000">https://refactoring.guru/design-patterns/observer</tspan></a></p><a 
 id="x1-8007x3.3"></a>
<!--l. 415--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn9x0-bk" id="fn9x0"><sup class="textsuperscript">9</sup></a></span>    <a 
href="https://www.codefellows.org/blog/what-is-a-callback-anyway/" class="url" ><tspan font-family="\ectt" font-size="\1000">https://www.codefellows.org/blog/what-is-a-callback-anyway/</tspan></a></p><a 
 id="x1-8012x3.3"></a>
<!--l. 449--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn10x0-bk" id="fn10x0"><sup class="textsuperscript">10</sup></a></span>    <a 
href="https://www.oracle.com/java/technologies/appmodel.html" class="url" ><tspan font-family="\ectt" font-size="\1000">https://www.oracle.com/java/technologies/appmodel.html</tspan></a></p><a 
 id="x1-8015x3.3"></a>
<!--l. 465--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn11x0-bk" id="fn11x0"><sup class="textsuperscript">11</sup></a></span>    <a 
href="https://www.educative.io/edpresso/why-use-javabean" class="url" ><tspan font-family="\ectt" font-size="\1000">https://www.educative.io/edpresso/why-use-javabean</tspan></a></p>                                         </div>
 
</body></html> 

                                                                                                    


