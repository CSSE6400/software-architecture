Last Updated on 2023/02/17
                                                                                                    

<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>Infrastructure as Code</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- fn-in,html,htex4ht,xhtml --> 
<meta name="src" content="main.tex" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<link rel="stylesheet" href="https://latex.now.sh/style.css"> 
<link rel="stylesheet" href="/notes.css"> 
<style>body {max-width: 100ch;} 
dl dd {text-align: left}</style> 
</head><body 
>
   <div class="maketitle"><a 
 id="Q1-1-1"></a>
_________________________________________________________________________________________________
<h2 class="titleHead">Infrastructure as Code</h2>                                                                  Software Architecture
   <div class="date" >March 17, 2025</div>                                                                                                                                                       <div class="author" >Brae
Webb</div>
______________________________________________________________________________________________
   </div>
   <h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 8--><p class="noindent" >Configuration management can be one of the more challenging aspects of software development. In
sophisticated architectures there are roughly two layers of configuration management: machine configuration; and
stack configuration.
</p><!--l. 12--><p class="indent" >
      </p><dl class="description"><dt class="description">
<span 
class="Cabin-Bold-tlf-t1-x-x-120">Machine configuration</span> </dt><dd 
class="description">
      <!--l. 13--><p class="noindent" >encompasses software dependencies, operating system configuration, environment variables, and
      every other aspect of a machine&#8217;s environment.
      </p></dd><dt class="description">
<span 
class="Cabin-Bold-tlf-t1-x-x-120">Stack configuration</span> </dt><dd 
class="description">
      <!--l. 15--><p class="noindent" >encompasses the configuration of an architecture&#8217;s infrastructure resources. Infrastructure includes
      compute, storage, and networking resources.</p></dd></dl>
<!--l. 19--><p class="indent" >   In a sense, machine configuration is a subset of the stack configuration, however, stack configuration tends to
be focussed on a higher level of abstraction. In this course, our focus when looking at Infrastructure as Code (IaC) is
<span 
class="Cabin-Italic-tlf-t1-x-x-120">stack configuration</span>. We rely on containerization tools, such as Docker, to fill the hole left by the lack of treatment of
machine configuration.
</p><!--l. 24--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-20002"></a>Brief History</h3>
<!--l. 25--><p class="noindent" >In the &#8216;Iron Age&#8217; of computing, installing a new server was rate limited by how quickly you could shop for and order
a new physical machine. Once the machine arrived at your company, some number of weeks after the purchase,
someone was tasked with setting it up, configuring it to talk to other machines, and installing all the software it
needed. Compared to the weeks it takes to acquire the machine, a day of configuration is not so bad. Furthermore,
because so much physical effort was needed to provision a new machine, a single developer would only be
responsible for a few machines.
</p><!--l. 36--><p class="indent" >   With virtualization one physical machine can be the home of numerous virtual machines. Each one of these
machines requires configuration. Now, with new machines available within minutes and no physical
labour involved, spending a day of configuring is out of the question &#8212; introducing: <span 
class="Cabin-Italic-tlf-t1-x-x-120">infrastructure</span>
<span 
class="Cabin-Italic-tlf-t1-x-x-120">code</span>.
                                                                                                    
                                                                                                    
</p><!--l. 42--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-30003"></a>Infrastructure Code</h3>
<!--l. 44--><p class="noindent" >Infrastructure code arose to ease the burden of the increased complexity where each developer
configured and maintained many more machines. Infrastructure code encompasses any code that
helps manage our infrastructure. Infrastructure code can often be quite simple. A shell script which
installs dependencies is infrastructure code. There&#8217;s an assortment of infrastructure code out in the
world today, ranging from simple shell scripts up to more sophisticated tools such as Ansible and
Terraform.
<a 
 id="x1-3001r1"></a>
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-1">     
<div class="tcolorbox-content"><!--l. 50--><p class="noindent" ><span 
class="Cabin-Bold-tlf-t1-x-x-120">Definition</span><span 
class="Cabin-Bold-tlf-t1-x-x-120">&#x00A0;1. Infrastructure Code</span>
</p><!--l. 51--><p class="noindent" >Code that provisions and manages infrastructure resources. </p> 
</div> 
</div>
<a 
 id="x1-3002r2"></a>
   <div class="tcolorbox tcolorbox" id="tcolobox-2">     
<div class="tcolorbox-content"><!--l. 54--><p class="noindent" ><span 
class="Cabin-Bold-tlf-t1-x-x-120">Definition</span><span 
class="Cabin-Bold-tlf-t1-x-x-120">&#x00A0;2. Infrastructure Resources</span>
</p><!--l. 55--><p class="noindent" >Compute resources, networking resources, and storage resources. </p> 
</div> 
</div>
<!--l. 58--><p class="indent" >   To explore the range of infrastructure code available, skim the below examples of infrastructure code in BASH,
Python, and Terraform. Each snippet performs the same functionality. Infrastructure Code does not have to be
strictly tools such as Terraform, although the two are often conflated. One thing which should be noted is that
Infrastructure Code specific languages, unlike most traditional software, is tending towards a declarative
paradigm.
</p>
   <div class="framedenv" id="code-1">
                 <!--l. 66--><p class="indent" >
                 <a 
 id="x1-3002r3"></a></p><!--l. 66--><pre class="listings" id="listing-1"><span class="label"><a 
 id="x1-3003r1"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">1</span></span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"><span 
class="ectt-1200">!/</span></span><span style="color:#33997E"><span 
class="ectt-1200">bin</span></span><span style="color:#33997E"><span 
class="ectt-1200">/</span></span><span style="color:#33997E"><span 
class="ectt-1200">bash</span></span> 
<span class="label"><a 
 id="x1-3004r2"></a></span> 
<span class="label"><a 
 id="x1-3005r3"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">3</span></span><span style="color:#000000"><span 
class="ectt-1200">SG</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">aws</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">security</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">group</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">...)</span></span> 
<span class="label"><a 
 id="x1-3006r4"></a></span> 
<span class="label"><a 
 id="x1-3007r5"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">5</span></span><span style="color:#000000"><span 
class="ectt-1200">aws</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">authorize</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">security</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">group</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">ingress</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"><span 
class="ectt-1200">group</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">$SG</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-3008r6"></a></span> 
<span class="label"><a 
 id="x1-3009r7"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">7</span></span><span style="color:#000000"><span 
class="ectt-1200">INST</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">aws</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">instances</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"><span 
class="ectt-1200">security</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">group</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">ids</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">$SG</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">\</span></span> 
<span class="label"><a 
 id="x1-3010r8"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">8</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"><span 
class="ectt-1200">instance</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#006699"><span 
class="ectt-1200">type</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">t2</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">micro</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-3011r9"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">9 </span></span></pre><a 
 id="x1-3011r3"></a>
   </div>
   <div class="framedenv" id="code-1">
        <!--l. 77--><p class="indent" >
        <a 
 id="x1-3011r3"></a></p><!--l. 77--><pre class="listings" id="listing-2"><span class="label"><a 
 id="x1-3012r1"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">1</span></span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">boto3</span></span> 
<span class="label"><a 
 id="x1-3013r2"></a></span> 
<span class="label"><a 
 id="x1-3014r3"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">3</span></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-3015r4"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">4</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">ec2_client</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">boto3</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">client</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">ec2</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">region_name</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">us</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">east</span></span><span style="color:#669900"><span 
class="ectt-1200">-1</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-3016r5"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">5</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">response</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">create_security_group</span></span><span style="color:#000000"><span 
class="ectt-1200">(...)</span></span> 
<span class="label"><a 
 id="x1-3017r6"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">6</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">security_group_id</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">response</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">GroupId</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-3018r7"></a></span> 
<span class="label"><a 
 id="x1-3019r8"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">8</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">data</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">authorize_security_group_ingress</span></span><span style="color:#000000"><span 
class="ectt-1200">(...)</span></span> 
<span class="label"><a 
 id="x1-3020r9"></a></span> 
<span class="label"><a 
 id="x1-3021r10"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">10</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">instance</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2_client</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">run_instances</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span> 
<span class="label"><a 
 id="x1-3022r11"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">11</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">SecurityGroups</span></span><span style="color:#000000"><span 
class="ectt-1200">=[</span></span><span style="color:#000000"><span 
class="ectt-1200">security_group_id</span></span><span style="color:#000000"><span 
class="ectt-1200">],</span></span> 
<span class="label"><a 
 id="x1-3023r12"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">12</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">InstanceType</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">t2</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">micro</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-3024r13"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">13</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-3025r14"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">14</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-3026r15"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">15 </span></span></pre><a 
 id="x1-3026r3"></a>
   </div>
   <div class="framedenv" id="code-1">
    <!--l. 94--><p class="indent" >
    <a 
 id="x1-3026r3"></a></p><!--l. 94--><pre class="listings" id="listing-3"><span class="label"><a 
 id="x1-3027r1"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">1</span></span><span style="color:#006699"><span 
class="ectt-1200">resource</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">server</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-3028r2"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">2</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">instance_type</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">t2</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">micro</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-3029r3"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">3</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">security_groups</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">aws_security_group</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-3030r4"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">4</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-3031r5"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">5</span></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-3032r6"></a></span> 
<span class="label"><a 
 id="x1-3033r7"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">7</span></span><span style="color:#006699"><span 
class="ectt-1200">resource</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws_security_group</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">server</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-3034r8"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">8</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">ingress</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-3035r9"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">9</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">from_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">80</span></span> 
<span class="label"><a 
 id="x1-3036r10"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">10</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">to_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">80</span></span> 
<span class="label"><a 
 id="x1-3037r11"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">11</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-3038r12"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">12</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-3039r13"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">13</span></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-3040r14"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">14</span></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-3041r15"></a><span 
class="Cabin-Regular-tlf-t1-x-x-60">15 </span></span></pre><a 
 id="x1-3041r3"></a>
   </div>
<!--l. 134--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-40004"></a>Infrastructure as Code</h3>
<!--l. 136--><p class="noindent" >In this course, we have chosen to make a distinction between <span 
class="Cabin-Italic-tlf-t1-x-x-120">Infrastructure Code </span>and <span 
class="Cabin-Italic-tlf-t1-x-x-120">Infrastructure as Code</span>. We
define <span 
class="Cabin-Italic-tlf-t1-x-x-120">Infrastructure Code </span>as above, as code which manages infrastructure. We separately define <span 
class="Cabin-Italic-tlf-t1-x-x-120">Infrastructure as</span>
                                                                                                    
                                                                                                    
<span 
class="Cabin-Italic-tlf-t1-x-x-120">Code </span>as the practices of treating Infrastructure Code as if it were traditional code. In the real world
no distinction is made. We now introduce <span 
class="Cabin-Italic-tlf-t1-x-x-120">Infrastructure as Code </span>and clarify why this distinction is
important.
<a 
 id="x1-4001r3"></a>
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-3">     
<div class="tcolorbox-content"><!--l. 143--><p class="noindent" ><span 
class="Cabin-Bold-tlf-t1-x-x-120">Definition</span><span 
class="Cabin-Bold-tlf-t1-x-x-120">&#x00A0;3. Infrastructure as Code</span>
</p><!--l. 144--><p class="noindent" >Following the same good coding practices to manage Infrastructure Code as standard code. </p> 
</div> 
</div>
<!--l. 147--><p class="indent" >   Given the above definition of IaC, the natural follow-up question is &#8216;what are good coding practices?&#8217;. Before
reading further, pause for a moment and consider what coding practices you follow when developing software
that you would consider good practice. Got some ideas? Good, let&#8217;s enumerate a few that we think are
important.
</p><!--l. 154--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1    </span> <a 
 id="x1-50004.1"></a>Everything as Code</h4>
<!--l. 155--><p class="noindent" >Everything as Code is a good coding practice which seems so obvious in regular programming that it is rarely
discussed. The idea is to ensure that your code does not depend on manual tasks being performed. Unfortunately,
as developers are already familiar with their cloud platform&#8217;s UI, it can be easy to take the easy way and to quickly
provision a resource in the UI.
</p><!--l. 160--><p class="indent" >   Introducing manual changes outside of your Infrastructure Code creates <span 
class="Cabin-Italic-tlf-t1-x-x-120">configuration drift</span>, infrastructure
configuration which has diverged from your Infrastructure Code. Configuration drift can produce <span 
class="Cabin-Italic-tlf-t1-x-x-120">snowflake</span>
machines, unique machines which your project depends on but no one can safely recreate. Once you introduce
just one snowflake machine into your infrastructure, the benefit of reproducibility afforded by IaC is
lost.
</p><!--l. 166--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2    </span> <a 
 id="x1-60004.2"></a>Version Control</h4>
<!--l. 167--><p class="noindent" >We hope that everyone can agree that version control in regular code is a luxury we would not wish to live without.
It should then be common sense to apply the benefits of version control; restorable code, accountable code, and
working collaboratively to Infrastructure Code.
</p><!--l. 171--><p class="indent" >   There is however, one significant catch with versioning infrastructure code: <span 
class="Cabin-Italic-tlf-t1-x-x-120">state</span>. Most Infrastructure Code
tools utilize some form of state. In Terraform, applying changing updates a file called <span 
class="Cabin-Italic-tlf-t1-x-x-120">terraform.tfstate</span>. The state is
important to map the resources specified in Infrastructure Code to their real-world counterparts. However, the
state is updated frequently and needs to be kept in live-sync between all developers. These requirements make
version controlling state a generally bad idea. The solution is counter-intuitively a remote state which
exists outside of Terraform controlled infrastructure and out of reach of version control. A remote
state might exist on an S3 bucket which all developers can access and update in real time. An non
version controlled file such as this might seem like a step backwards, however, if you consider it as
a cache sitting between your Infrastructure Code and your infrastructure it is a <span 
class="Cabin-Italic-tlf-t1-x-x-120">slightly </span>nicer pill to
swallow.
</p><!--l. 182--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3    </span> <a 
 id="x1-70004.3"></a>Automation</h4>
                                                                                                    
                                                                                                    
<!--l. 183--><p class="noindent" >The goal of Infrastructure Code is to help developers manage the complexity of resource management via
automation. In order to maximize our confidence that Infrastructure Code is reflected in reality, it is important that
our build pipelines provide an assurance of consistency.
</p><!--l. 187--><p class="indent" >   There are two methods for achieving consistency through automation: fail the pipeline if the Infrastructure
Code would change the reality; or make changes to reality in our pipeline. Either of these options would ensure
that the checked-in Infrastructure Code is an accurate reflection of reality that developers can safely build
atop.
</p><!--l. 190--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4    </span> <a 
 id="x1-80004.4"></a>Code Reuse</h4>
<!--l. 191--><p class="noindent" >A good developer should embody the practice of working smarter not harder &#8212; it&#8217;s the core practice of our
industry. When developing Infrastructure Code it is important to remember that you are (likely) not the first to
solve this problem. You&#8217;re not the first person to connect a public EC2 instance to an S3 bucket. A
good coding practice that happens to be a win-win for everyone is code reuse. You can&#8217;t copy and
paste another developer&#8217;s mouse clicks to configure their server via a UI, but you can, and in most
cases should, import the Terraform module they published to configure servers in just the way you
needed.
</p><!--l. 200--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.5    </span> <a 
 id="x1-90004.5"></a>Testing</h4>
<!--l. 201--><p class="noindent" >We&#8217;ll cover testing in the lecture :)
</p><!--l. 203--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5    </span> <a 
 id="x1-100005"></a>Conclusion</h3>
<!--l. 204--><p class="noindent" >We have looked at Infrastructure Code which enables developers to manage the vast amount of
infrastructure resources necessitated by the Cloud Age. Then we explored the benefits of applying the good
coding practices we know and love from regular programming to Infrastructure Code. We termed this
practice Infrastructure as Code despite the tools (Infrastructure Code) and practices (Infrastructure as
Code) being combined in the real world as Infrastructure as Code. It is important to note that IaC
is still in relatively early stages, there are a number of issues which need to be addressed, such as:
importing existing infrastructure; improving state management; and enabling proper refactoring.
Despite these issues, it is the best system we have to date and a significant improvement on manual
management.
</p><!--l. 212--><p class="indent" >
      Infrastructure as Code is the worst form of infrastructure management except for all those
      other forms that have been tried from time to time.
                                                                                             </p><!--l. 215--><p class="noindent" >&#8211;
                                                                                   Paraphrased
                                                                                      Winston
                                                                                      Churchill
                                                                                                    
                                                                                                    
</p>
    
</body></html> 

                                                                                                    


