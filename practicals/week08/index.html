Last Updated on 2023/04/25      

<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>Load Testing &amp; Bottlenecks</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- fn-in,html,htex4ht,xhtml --> 
<meta name="src" content="main.tex" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<link rel="stylesheet" href="https://latex.now.sh/style.css"> 
<link rel="stylesheet" href="/notes.css"> 
<style>body {max-width: 100ch;} 
dl dd {text-align: left}</style> 
</head><body 
>
   <div class="maketitle"><a 
 id="Q1-1-1"></a>
_________________________________________________________________________________________________ <h2 class="titleHead">Load
Testing &amp; Bottlenecks</h2>                                                                   Software Architecture
   <div class="date" >April 26, 2023</div>                                                                                                                                                         <div class="author" >Brae
Webb</div>
______________________________________________________________________________________________
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<!--l. 19--><p class="noindent" ><img 
src="images/bottleneck.png" alt="PIC"  
width="420" height="420"  />
                                                                                                    
                                                                                                    
</p>
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-10001"></a>This Week</h3>
<!--l. 23--><p class="noindent" >Our goal is to: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 25--><p class="noindent" >Introduce structured logging to TaskOverflow.
      </p></li>
      <li class="itemize">
      <!--l. 26--><p class="noindent" >Deploy TaskOverflow to AWS.
      </p></li>
      <li class="itemize">
      <!--l. 27--><p class="noindent" >Write k6 tests to ensure TaskOverflow can handle given scenarios.
      </p></li>
      <li class="itemize">
      <!--l. 28--><p class="noindent" >Uncover and fix bottlenecks in the TaskOverflow application using the logs.</p></li></ul>
<!--l. 31--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-20002"></a>Watchtower</h3>
<!--l. 32--><p class="noindent" >In this course we have repeatedly claimed that there is value in montoring and logging. This week, we aim to prove
it by using logging to help diagnose issues with a deployment of TaskOverflow. For this task, we have integrated
<a 
href="https://pypi.org/project/watchtower/" >Watchtower</a><span class="footnote-mark"><a 
href="#fn1x0" id="fn1x0-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2001f1"></a>
into the project. Watchtower is a Python library that allows us to send logs to AWS CloudWatch, allowing us to
monitor the applications performance in real time.
</p><!--l. 38--><p class="indent" >   Currently the project is configured to log API accesses made with Flask and to log database queries created by
SQL Alchemy. This results in an unstructured log stream as seen in Figure <a 
href="#x1-2003r1">1<!--tex4ht:ref: fig:cloud-logs --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
<a 
 id="x1-2003r1"></a>
                                                                                                    
                                                                                                    
<!--l. 42--><p class="noindent" ><img 
src="images/cloud-watch-log.png" alt="PIC"  
width="525" height="525"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">An example of logs made to AWS CloudWatch for a DELETE request in the TaskOverflow API.</span></div><!--tex4ht:label?: x1-2003r1 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
<!--l. 47--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-3000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">Getting Started</span></span>
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-3002x1">
      <!--l. 49--><p class="noindent" >Using the GitHub Classroom link for this practical provided by your tutor in Slack, create a repository
      to work within.
      </p></li>
<li 
  class="enumerate" id="x1-3004x2">
      <!--l. 50--><p class="noindent" >Install Terraform if not already installed, as it will be required again this week.
      </p></li>
<li 
  class="enumerate" id="x1-3006x3">
      <!--l. 51--><p class="noindent" >Start your learner lab and copy the AWS Learner Lab credentials into a credentials file in the root of
      the repository.</p></li></ol>
<!--l. 54--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-4000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">What&#8217;s New</span></span>
   We are returning to TaskOverflow roughly from the state at the end of the last practical. The following notable
changes have been made: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 58--><p class="noindent" ><span 
class="ectt-1200">Watchtower </span>has been installed as a dependency.
      </p></li>
      <li class="itemize">
      <!--l. 59--><p class="noindent" >In <span 
class="ectt-1200">docker-compose.yml</span>, we mount the <span 
class="ectt-1200">credentials </span>file to <span 
class="ectt-1200">/root/.aws/credentials</span>. This allows
      local testing of <span 
class="ectt-1200">watchtower </span>to log to AWS CloudWatch.
      </p></li>
      <li class="itemize">
      <!--l. 61--><p class="noindent" >Logging has been introduced for Flask and SQL Alchemy.</p></li></ul>
<!--l. 64--><p class="indent" >   Our first task will be to replicate the above logs in Figure <a 
href="#x1-2003r1">1<!--tex4ht:ref: fig:cloud-logs --></a>. Once you have copied <span 
class="ectt-1200">credentials </span>into the project
root, start docker compose with:  </p><div class="framedenv" id="shaded*-1">
   <!--l. 67-->
<pre class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-4001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">docker</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">compose</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">up</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
   <div class="framedenv" id="code-1">
<!--l. 69--><pre class="listings" id="listing-2"><span class="label"><a 
 id="x1-4002r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Serving</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Flask</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span></span> 
<span class="label"><a 
 id="x1-4003r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Debug</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">mode</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">on</span></span> 
<span class="label"><a 
 id="x1-4004r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">werkzeug</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">WARNING</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">This</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">development</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Do</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">not</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">use</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">it</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">production</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">deployment</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Use</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">production</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">WSGI</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">instead</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span> 
<span class="label"><a 
 id="x1-4005r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Running</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">on</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">all</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">addresses</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(0.0.0.0)</span></span> 
<span class="label"><a 
 id="x1-4006r5"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Running</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">on</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://127.0.0.1:6400</span></span> 
<span class="label"><a 
 id="x1-4007r6"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Running</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">on</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://192.168.96.3:6400</span></span> 
<span class="label"><a 
 id="x1-4008r7"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">werkzeug</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">Press</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">CTRL</span></span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"><span 
class="ectt-1200">C</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">quit</span></span> 
<span class="label"><a 
 id="x1-4009r8"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">werkzeug</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Restarting</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">with</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">stat</span></span> 
<span class="label"><a 
 id="x1-4010r9"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">botocore</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">credentials</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">Found</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">credentials</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">shared</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">credentials</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">file</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">~/.</span></span><span style="color:#000000"><span 
class="ectt-1200">aws</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">credentials</span></span> 
<span class="label"><a 
 id="x1-4011r10"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">select</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">version</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-4012r11"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:[</span></span><span style="color:#000000"><span 
class="ectt-1200">raw</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sql</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{}</span></span> 
<span class="label"><a 
 id="x1-4013r12"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">select</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">current_schema</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-4014r13"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:[</span></span><span style="color:#000000"><span 
class="ectt-1200">raw</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sql</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{}</span></span> 
<span class="label"><a 
 id="x1-4015r14"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">show</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">standard_conforming_strings</span></span> 
<span class="label"><a 
 id="x1-4016r15"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:[</span></span><span style="color:#000000"><span 
class="ectt-1200">raw</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sql</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{}</span></span> 
<span class="label"><a 
 id="x1-4017r16"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">BEGIN</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">implicit</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-4018r17"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">SELECT</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_class</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">relname</span></span> 
<span class="label"><a 
 id="x1-4019r18"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">FROM</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_class</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">JOIN</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_namespace</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ON</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_namespace</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">oid</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_class</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">relnamespace</span></span> 
<span class="label"><a 
 id="x1-4020r19"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">WHERE</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_class</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">relname</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">%(</span></span><span style="color:#000000"><span 
class="ectt-1200">table_name</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">AND</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_class</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">relkind</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ANY</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">ARRAY</span></span><span style="color:#000000"><span 
class="ectt-1200">[%(</span></span><span style="color:#000000"><span 
class="ectt-1200">param_1</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">%(</span></span><span style="color:#000000"><span 
class="ectt-1200">param_2</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">%(</span></span><span style="color:#000000"><span 
class="ectt-1200">param_3</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">%(</span></span><span style="color:#000000"><span 
class="ectt-1200">param_4</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">%(</span></span><span style="color:#000000"><span 
class="ectt-1200">param_5</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">])</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">AND</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_table_is_visible</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_class</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">oid</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">AND</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_namespace</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">nspname</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">!=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">%(</span></span><span style="color:#000000"><span 
class="ectt-1200">nspname_1</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span> 
<span class="label"><a 
 id="x1-4021r20"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:[</span></span><span style="color:#000000"><span 
class="ectt-1200">generated</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0.00011</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">table_name</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">param_1</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">param_2</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">p</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">param_3</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">f</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">param_4</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">v</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">param_5</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">m</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">nspname_1</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">pg_catalog</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-4022r21"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">INFO</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">engine</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Engine</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">COMMIT</span></span> 
<span class="label"><a 
 id="x1-4023r22"></a></span><span style="color:#000000"><span 
class="ectt-1200">app_1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">WARNING</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">werkzeug</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Debugger</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">active</span></span><span style="color:#000000"><span 
class="ectt-1200">!</span></span>
 
<span class="label"><a 
 id="x1-4024r23"></a></span></pre>
                                                                                                    
                                                                                                    
   </div>
<!--l. 94--><p class="indent" >   You should see logs similar to the above. Notice that information about Flask is prefixed with <span 
class="ectt-1200">INFO:werkzeug</span>
and information about SQL Alchemy is prefixed with <span 
class="ectt-1200">INFO:sqlalchemy.engine.Engine</span>. This prefix indicates
which log stream they are put into.
</p><!--l. 98--><p class="indent" >   Open the AWS CloudWatch console and go to <span 
class="ectt-1200">Log groups </span>on the side panel. You should see a log group
called <span 
class="ectt-1200">taskoverflow</span>, if you click on that group you can see the two log streams.
</p>
<div class="center" 
>
<!--l. 102--><p class="noindent" >
</p><!--l. 103--><p class="noindent" ><img 
src="images/log-group.png" alt="PIC"  
width="420" height="420"  /></p></div>
<!--l. 106--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1    </span> <a 
 id="x1-50002.1"></a>Structured Logging</h4>
<!--l. 108--><p class="noindent" >Our first task will be to convert the current logging into a structured logging format. As we saw in last weeks
tutorial, structured logging can be as simple as logging a JSON object. This allows logging services to quickly filter
through logs based on criteria on the objects fields.
</p><!--l. 112--><p class="indent" >   In <span 
class="ectt-1200">todo/__init__.py </span>we have the following code within the <span 
class="ectt-1200">create_app </span>function. This code configures
watchtower to log to AWS CloudWatch.
</p><!--l. 115--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 115--><p class="indent" >   <span 
class="ectt-1200">» cat todo/__init__.py</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 115--><pre class="listings" id="listing-3"><span class="label"><a 
 id="x1-5001r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-5002r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-5003r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">handler</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">watchtower</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">CloudWatchLogHandler</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span> 
<span class="label"><a 
 id="x1-5004r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">log_group_name</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">taskoverflow</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-5005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">boto3_client</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">boto3</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">client</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">logs</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">region_name</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">us</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">east</span></span><span style="color:#669900"><span 
class="ectt-1200">-1</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">logger</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">addHandler</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">handler</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span>
 
<span class="label"><a 
 id="x1-5009r9"></a></span></pre>
   </div>
<!--l. 126--><p class="indent" >   We want to wrap all our logs in JSON objects and inject metadata to these objects. This allows us to
search the logs with greater ease. To do this, we will create a custom log formatter that is a subclass of
<span 
class="ectt-1200">watchtower.CloudWatchLogFormatter</span>.
</p><!--l. 131--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 131--><p class="indent" >   <span 
class="ectt-1200">» cat todo/__init__.py</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 131--><pre class="listings" id="listing-4"><span class="label"><a 
 id="x1-5010r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">has_request_context</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span> 
<span class="label"><a 
 id="x1-5011r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-5012r3"></a></span> 
<span class="label"><a 
 id="x1-5013r4"></a></span><span style="color:#006699"><span 
class="ectt-1200">class</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">StructuredFormatter</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">watchtower</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">CloudWatchLogFormatter</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-5014r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">format</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-5015r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">msg</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-5016r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">timestamp</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">created</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-5017r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">location</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-5018r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">message</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">msg</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-5019r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-5020r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">has_request_context</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-5021r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">msg</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">request_id</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">environ</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">REQUEST_ID</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5022r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">msg</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">url</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">environ</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">PATH_INFO</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5023r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">msg</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">method</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">environ</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">REQUEST_METHOD</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5024r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">super</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#006699"><span 
class="ectt-1200">format</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">record</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5025r16"></a></span> 
<span class="label"><a 
 id="x1-5026r17"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-5027r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-5028r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">handler</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-5029r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">handler</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">setFormatter</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">StructuredFormatter</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-5030r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span>
 
<span class="label"><a 
 id="x1-5031r22"></a></span></pre>
   </div>
<!--l. 155--><p class="indent" >   These are just some metadata fields we might want to add to our logging. We may also consider
<span 
class="ectt-1200">socket.gethostname() </span>to identify the instance handling a request or other helpful information.
</p><!--l. 158--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2    </span> <a 
 id="x1-60002.2"></a>Correlation IDs</h4>
<!--l. 160--><p class="noindent" >Correlation IDs are a mechanism to help understand the path of a request, event, message, etc. through a system.
When logging it can be helpful to be able to trace the execution of a particular request.
</p><!--l. 163--><p class="indent" >   For our system we will generate a new random identifier for each incoming request. This identifier will be
included as part of the logging metadata. For a system with multiple API endpoints requests will often come with
an established REQUEST_ID header.
</p><!--l. 167--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 167--><p class="indent" >   <span 
class="ectt-1200">» cat todo/__init__.py</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 167--><pre class="listings" id="listing-5"><span class="label"><a 
 id="x1-6001r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">uuid</span></span> 
<span class="label"><a 
 id="x1-6002r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-6003r3"></a></span> 
<span class="label"><a 
 id="x1-6004r4"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-6005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-6006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">requests</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">logging</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">getLogger</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">requests</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-6007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">requests</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">addHandler</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">handler</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-6008r8"></a></span> 
<span class="label"><a 
 id="x1-6009r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">@app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">before_request</span></span> 
<span class="label"><a 
 id="x1-6010r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">before_request</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-6011r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">environ</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">REQUEST_ID</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">str</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">uuid</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">uuid4</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-6012r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">requests</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">info</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">started</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-6013r13"></a></span> 
<span class="label"><a 
 id="x1-6014r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">@app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">after_request</span></span> 
<span class="label"><a 
 id="x1-6015r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">after_request</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">response</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-6016r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">requests</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">info</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">finished</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-6017r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">response</span></span> 
<span class="label"><a 
 id="x1-6018r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">...</span></span>
 
<span class="label"><a 
 id="x1-6019r19"></a></span></pre>
                                                                                                    
                                                                                                    
   </div>
<!--l. 188--><p class="indent" >   The above in <span 
class="ectt-1200">create_app </span>will generate a unique identifier to each incoming request. It will also log when a
request starts being processed and when it finishes processing.
</p><!--l. 192--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3    </span> <a 
 id="x1-70002.3"></a>Verify and Refine</h4>
<!--l. 193--><p class="noindent" >Ensure that the above modifications are working as expected by returning to the AWS CloudWatch logs. Launch
the service locally and make some API requests.
</p><!--l. 196--><p class="indent" >   You should now be able to go to the <span 
class="Cabin-Italic-tlf-t1-x-x-120">Log Insights </span>interface from the sidebar. As we saw in the tutorial, this
interface allows you to make queries about structured logging data. Give the following query a try to ensure that
your logs seem sensible.
</p>
   <div class="framedenv" id="code-1">
<!--l. 201--><pre class="listings" id="listing-6"><span class="label"><a 
 id="x1-7001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">fields</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request_id</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">method</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">@timestamp</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">message</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">message</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">@message</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">@method</span></span> 
<span class="label"><a 
 id="x1-7002r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">filter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">not</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">isempty</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">request_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-7003r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">limit</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">400</span></span>
 
<span class="label"><a 
 id="x1-7004r4"></a></span></pre>
   </div>
<!--l. 207--><p class="indent" >   Take the time to refine your logging now to produce logs that are easy to search through and understand the
trace of your API requests.
</p><!--l. 210--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-80003"></a>Load Testing</h3>
<!--l. 212--><p class="noindent" >We will now generate some load on our API using <span 
class="ectt-1200">k6 </span>and see how it performs. We briefly saw <span 
class="ectt-1200">k6 </span>at the end of the
week 7 practical. To refresh, <span 
class="ectt-1200">k6 </span>is a load testing tool that is written in Go but provides an interface using a
JavaScript subset.
</p><!--l. 216--><p class="indent" >   It will help us to generate a large number of concurrent API requests. Go ahead and install <span 
class="ectt-1200">k6</span>: 
<a 
href="https://k6.io/docs/get-started/installation/" class="url" ><span 
class="ectt-1200">https://k6.io/docs/get-started/installation/</span></a>
</p><!--l. 220--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-90003.1"></a>Scenario</h4>
<!--l. 221--><p class="noindent" >We want to simulate the following scenario using our testing framework.
</p>
<!--l. 223--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-10000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">Indecisive planners and studious reviewers</span></span>
   Our TaskOverflow application is being used at a point in semester where most students have already setup
their tasks. These students are routinely visiting the website and listing the tasks they have yet to complete. At the
same time, there are 40 very indecisive students who, quite late in semester, are trying to setup their tasks for the
rest of semester. They continually create a task, realise that they&#8217;re mis-typed, delete the task, and start
over.
</p><!--l. 234--><p class="indent" >   As the tasks are shared globally amongst all students, the indecisive planners are altering the list of task seen
by the organised students.
                                                                                                    
                                                                                                    
</p><!--l. 237--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-110003.2"></a>Setup</h4>
<!--l. 238--><p class="noindent" >To get started, we will create a file called <span 
class="ectt-1200">planners-and-studiers.js</span>. Most <span 
class="ectt-1200">k6 </span>tests start with the following
imports.
</p><!--l. 242--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 242--><p class="indent" >   <span 
class="ectt-1200">» cat planners-and-studiers.js</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 242--><pre class="listings" id="listing-7"><span class="label"><a 
 id="x1-11001r1"></a></span><span style="color:#404040"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">k6</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">http</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-11002r2"></a></span><span style="color:#404040"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">check</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sleep</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">}</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">k6</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-11003r3"></a></span> 
<span class="label"><a 
 id="x1-11004r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">const</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ENDPOINT</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">__ENV</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">ENDPOINT</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span>
 
<span class="label"><a 
 id="x1-11005r5"></a></span></pre>
   </div>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 250--><p class="noindent" ><span 
class="ectt-1200">http </span>holds the methods used to make HTTP requests,
      </p></li>
      <li class="itemize">
      <!--l. 251--><p class="noindent" ><span 
class="ectt-1200">check </span>allows us to assert the state of HTTP responses, and
      </p></li>
      <li class="itemize">
      <!--l. 252--><p class="noindent" ><span 
class="ectt-1200">sleep </span>gives us the ability to put a simulated user to sleep rather than continuously spamming the
      service with requests.</p></li></ul>
<!--l. 255--><p class="indent" >   The ENDPOINT line retrieves the endpoint URL from the ENDPOINT environment variable.
</p><!--l. 257--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3    </span> <a 
 id="x1-120003.3"></a>User Simulation</h4>
<!--l. 259--><p class="noindent" >The behaviour of our users will be defined by an exported JavaScript function. Our studying student will be listing
out all of the tasks they have left to complete by using the <span 
class="ectt-1200">/api/v1/todos </span>endpoint.
</p><!--l. 262--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 262--><p class="indent" >   <span 
class="ectt-1200">» cat planners-and-studiers.js</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 262--><pre class="listings" id="listing-8"><span class="label"><a 
 id="x1-12001r1"></a></span><span style="color:#404040"><span 
class="ectt-1200">export</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">function</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">studyingStudent</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12002r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">let</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ENDPOINT</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">`</span><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="tctt-1200">`</span><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12003r3"></a></span> 
<span class="label"><a 
 id="x1-12004r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">//</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">What</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">tasks</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">do</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">I</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">have</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">left</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">work</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">on</span></span><span style="color:#33997E"><span 
class="ectt-1200">?</span></span> 
<span class="label"><a 
 id="x1-12005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">let</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12006r6"></a></span> 
<span class="label"><a 
 id="x1-12007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">check</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">is</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">status</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">200</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">status</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">===</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200,</span></span> 
<span class="label"><a 
 id="x1-12009r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">})</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12010r10"></a></span> 
<span class="label"><a 
 id="x1-12011r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">//</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Alright</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">I</span></span><span style="color:#33997E"><span 
class="tctt-1200">'</span></span><span style="color:#33997E"><span 
class="ectt-1200">ll</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">go</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">work</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">on</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">my</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">next</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">task</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">for</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">around</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">2</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">minutes</span></span> 
<span class="label"><a 
 id="x1-12012r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">sleep</span></span><span style="color:#000000"><span 
class="ectt-1200">(120)</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12013r13"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-12014r14"></a></span></pre>
   </div>
<!--l. 278--><p class="indent" >   Of course, this test is very basic as it only ensures the reponse code is 200. There is no guarantee that the
returned data is sensible.
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-1">    
<div class="tcolorbox-title">
<!--l. 287--><p class="indent" >   Info</p></div> 
<div class="tcolorbox-content"><!--l. 287--><p class="noindent" >If  you  would  like  a  challenge,  you  can  use  the  <span 
class="ectt-1200">randomIntBetween </span>function  to  have  the  studier
occasionally tick off tasks.
</p><!--l. 287--><p class="noindent" ><a 
href="https://k6.io/docs/javascript-api/jslib/utils/randomintbetween/" class="url" ><span 
class="ectt-1200">https://k6.io/docs/javascript-api/jslib/utils/randomintbetween/</span></a> </p> 
</div> 
</div>
<!--l. 289--><p class="indent" >   Next we need to handle our indecisive users. For them, we will need to make a POST request to the
<span 
class="ectt-1200">/api/v1/todos </span>endpoint to create a task. Then we will need to use the ID given by the POST response to
DELETE the mis-typed task.
</p><!--l. 293--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 293--><p class="indent" >   <span 
class="ectt-1200">» cat planners-and-studiers.js</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 293--><pre class="listings" id="listing-9"><span class="label"><a 
 id="x1-12015r1"></a></span><span style="color:#404040"><span 
class="ectt-1200">export</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">function</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">indecisivePlanner</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12016r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">let</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ENDPOINT</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">`</span><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="tctt-1200">`</span><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12017r3"></a></span> 
<span class="label"><a 
 id="x1-12018r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">//</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">I</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">need</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">work</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">on</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">CSSE6400</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Cloud</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Assignment</span></span><span style="color:#33997E"><span 
class="ectt-1200">!</span></span> 
<span class="label"><a 
 id="x1-12019r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">const</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">payload</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">JSON</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">stringify</span></span><span style="color:#000000"><span 
class="ectt-1200">({</span></span> 
<span class="label"><a 
 id="x1-12020r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">title</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">CSSE6400</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">Clout</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">Assignment</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-12021r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">completed</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">false</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-12022r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">description</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-12023r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">2023-12-04</span></span><span style="color:#669900"><span 
class="ectt-1200">T14</span></span><span style="color:#669900"><span 
class="ectt-1200">:00:00</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-12024r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">})</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12025r11"></a></span> 
<span class="label"><a 
 id="x1-12026r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">const</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">params</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12027r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">headers</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12028r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">Content</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">Type</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">application</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">json</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-12029r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-12030r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">};</span></span> 
<span class="label"><a 
 id="x1-12031r17"></a></span> 
<span class="label"><a 
 id="x1-12032r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">let</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">post</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">payload</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">params</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12033r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">check</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12034r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">is</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">status</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">200</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">status</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">===</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200,</span></span> 
<span class="label"><a 
 id="x1-12035r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">})</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12036r22"></a></span> 
<span class="label"><a 
 id="x1-12037r23"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">sleep</span></span><span style="color:#000000"><span 
class="ectt-1200">(10)</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12038r24"></a></span> 
<span class="label"><a 
 id="x1-12039r25"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">//</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Oh</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">no</span></span><span style="color:#33997E"><span 
class="ectt-1200">!</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Not</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Clout</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">assignment</span></span><span style="color:#33997E"><span 
class="ectt-1200">,</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Cloud</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">assignment</span></span><span style="color:#33997E"><span 
class="ectt-1200">!</span></span> 
<span class="label"><a 
 id="x1-12040r26"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">const</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">wrongId</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12041r27"></a></span> 
<span class="label"><a 
 id="x1-12042r28"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">delete</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span><span 
class="tctt-1200">`</span></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"><span 
class="ectt-1200">}/</span></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#000000"><span 
class="ectt-1200">wrongId</span></span><span style="color:#000000"><span 
class="ectt-1200">}</span><span 
class="tctt-1200">`</span><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12043r29"></a></span> 
<span class="label"><a 
 id="x1-12044r30"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">check</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12045r31"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">is</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">status</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">200</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">r</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">status</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">===</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200,</span></span> 
<span class="label"><a 
 id="x1-12046r32"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">})</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12047r33"></a></span> 
<span class="label"><a 
 id="x1-12048r34"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">//</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">I</span></span><span style="color:#33997E"><span 
class="tctt-1200">'</span></span><span style="color:#33997E"><span 
class="ectt-1200">ll</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">come</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">back</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">it</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">later</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">:(</span></span> 
<span class="label"><a 
 id="x1-12049r35"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">sleep</span></span><span style="color:#000000"><span 
class="ectt-1200">(10)</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span> 
<span class="label"><a 
 id="x1-12050r36"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-12051r37"></a></span></pre>
   </div>
                                                                                                    
                                                                                                    
<!--l. 332--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4    </span> <a 
 id="x1-130003.4"></a>Configure Behaviour</h4>
<!--l. 334--><p class="noindent" >We have now outlined how our user agents will interact with our API. We can use the <span 
class="ectt-1200">options </span>to
configure how these interactions occur over time. To prevent overloading the API immediately, and
allow any auto-scaling behaviour to be triggers, we will slowly increase the amount of studiers. We
will have a consistent amount of planners, 20, who will perform a total of 200 corrections over the
test.
</p><!--l. 342--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 342--><p class="indent" >   <span 
class="ectt-1200">» cat planners-and-studiers.js</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 342--><pre class="listings" id="listing-10"><span class="label"><a 
 id="x1-13001r1"></a></span><span style="color:#404040"><span 
class="ectt-1200">export</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">const</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">options</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13002r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">scenarios</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13003r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">studier</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13004r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">exec</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">studyingStudent</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">executor</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">ramping</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">vus</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">stages</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span> 
<span class="label"><a 
 id="x1-13007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">duration</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">2</span></span><span style="color:#669900"><span 
class="ectt-1200">m</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">target</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1000</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-13008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">duration</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">2</span></span><span style="color:#669900"><span 
class="ectt-1200">m</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">target</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">2500</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-13009r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">duration</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">2</span></span><span style="color:#669900"><span 
class="ectt-1200">m</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">target</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-13010r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">],</span></span> 
<span class="label"><a 
 id="x1-13011r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-13012r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">planner</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13013r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">exec</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">indecisivePlanner</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13014r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">executor</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">shared</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">iterations</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13015r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">vus</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">20,</span></span> 
<span class="label"><a 
 id="x1-13016r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">iterations</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">400,</span></span> 
<span class="label"><a 
 id="x1-13017r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-13018r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">},</span></span> 
<span class="label"><a 
 id="x1-13019r19"></a></span><span style="color:#000000"><span 
class="ectt-1200">};</span></span>
 
<span class="label"><a 
 id="x1-13020r20"></a></span></pre>
   </div>
<!--l. 364--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.5    </span> <a 
 id="x1-140003.5"></a>Running the tests</h4>
<!--l. 366--><p class="noindent" >Now we have a completed load test. Deploy the service to AWS:
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 369-->
<pre class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-14001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">apply</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 371--><p class="indent" >   Once the deployment is finished, you should be given a URL where the endpoint is deployed. Use that
endpoint to set the <span 
class="ectt-1200">ENDPOINT </span>environment variable and run the tests.
</p>
   <div class="framedenv" id="code-1">
<!--l. 375--><pre class="listings" id="listing-12"><span class="label"><a 
 id="x1-14002r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">export</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ENDPOINT</span></span><span style="color:#000000"><span 
class="ectt-1200">=...</span></span> 
<span class="label"><a 
 id="x1-14003r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">k6</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">planners</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">and</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">studiers</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">js</span></span>
 
<span class="label"><a 
 id="x1-14004r3"></a></span></pre>
   </div>
<!--l. 380--><p class="indent" >   These tests should take about 10 minutes to run. You should see that most of the tests pass but that there will
be a few failures throughout, as seen below.
</p>
   <div class="framedenv" id="code-1">
<!--l. 384--><pre class="listings" id="listing-13"><span class="label"><a 
 id="x1-14005r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0152]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400//</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14006r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0183]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14007r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0239]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14008r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0241]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14009r5"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0272]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14010r6"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0330]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14011r7"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0339]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14012r8"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0371]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14013r9"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0412]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14014r10"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0412]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14015r11"></a></span><span style="color:#000000"><span 
class="ectt-1200">WARN</span></span><span style="color:#000000"><span 
class="ectt-1200">[0467]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Request</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Failed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">error</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Get</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span><span style="color:#000000"><span 
class="ectt-1200">://54.166.206.229:6400/</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">v1</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">\</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">request</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">timeout</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14016r12"></a></span> 
<span class="label"><a 
 id="x1-14017r13"></a></span><span style="color:#000000"><span 
class="ectt-1200">running</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">(09</span></span><span style="color:#000000"><span 
class="ectt-1200">m30</span></span><span style="color:#000000"><span 
class="ectt-1200">.0</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0000/2520</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">VUs</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">4914</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">complete</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">and</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1947</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">interrupted</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">iterations</span></span> 
<span class="label"><a 
 id="x1-14018r14"></a></span><span style="color:#000000"><span 
class="ectt-1200">planner</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">100%</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">20</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">VUs</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">07</span></span><span style="color:#000000"><span 
class="ectt-1200">m09</span></span><span style="color:#000000"><span 
class="ectt-1200">.0</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"><span 
class="ectt-1200">/10</span></span><span style="color:#000000"><span 
class="ectt-1200">m0s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">400/400</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">shared</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">iters</span></span> 
<span class="label"><a 
 id="x1-14019r15"></a></span><span style="color:#000000"><span 
class="ectt-1200">studier</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">100%</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0000/2500</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">VUs</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">9</span></span><span style="color:#000000"><span 
class="ectt-1200">m0s</span></span> 
<span class="label"><a 
 id="x1-14020r16"></a></span> 
<span class="label"><a 
 id="x1-14021r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">status</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200</span></span> 
<span class="label"><a 
 id="x1-14022r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">94%</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">6646</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">411</span></span> 
<span class="label"><a 
 id="x1-14023r19"></a></span> 
<span class="label"><a 
 id="x1-14024r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">checks</span></span><span style="color:#000000"><span 
class="ectt-1200">.........................:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">94.17%</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">6646</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">411</span></span> 
<span class="label"><a 
 id="x1-14025r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">data_received</span></span><span style="color:#000000"><span 
class="ectt-1200">..................:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">166</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">MB</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">292</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">kB</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span> 
<span class="label"><a 
 id="x1-14026r22"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">data_sent</span></span><span style="color:#000000"><span 
class="ectt-1200">......................:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">727</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">kB</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1.3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">kB</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span> 
<span class="label"><a 
 id="x1-14027r23"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">iterations</span></span><span style="color:#000000"><span 
class="ectt-1200">.....................:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">4914</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">8.620734/</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span> 
<span class="label"><a 
 id="x1-14028r24"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">vus</span></span><span style="color:#000000"><span 
class="ectt-1200">............................:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">min</span></span><span style="color:#000000"><span 
class="ectt-1200">=1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">max</span></span><span style="color:#000000"><span 
class="ectt-1200">=2520</span></span> 
<span class="label"><a 
 id="x1-14029r25"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">vus_max</span></span><span style="color:#000000"><span 
class="ectt-1200">........................:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">2520</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">min</span></span><span style="color:#000000"><span 
class="ectt-1200">=2520</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">max</span></span><span style="color:#000000"><span 
class="ectt-1200">=2520</span></span>
 
<span class="label"><a 
 id="x1-14030r26"></a></span></pre>
   </div>
<!--l. 412--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-150004"></a>Debugging</h3>
<!--l. 414--><p class="noindent" >Now we can start to debug our service. We desire to not only increase our 94% pass rate to 100% but also to
increase the amount of studiers and planners.
                                                                                                    
                                                                                                    
</p><!--l. 417--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1    </span> <a 
 id="x1-160004.1"></a>Tips</h4>
<!--l. 419--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-17000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">Open TaskOverflow</span></span>
   If you open TaskOverflow, you should find it has been left in an unusual state after the tests. See if you can find
out from the logs how this occured.
</p>
<!--l. 424--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-18000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">Follow an Interaction</span></span>
   Use the correlation IDs that we have now included to see where potential bottlenecks may be occuring. You
can introduce more fine-grained logs to find where time is being spent.
</p><!--l. 428--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2    </span> <a 
 id="x1-190004.2"></a>Back-of-the-envelope</h4>
<!--l. 429--><p class="noindent" >Back-of-the-envelope calculations are normally quite helpful when trying to scale services. You need some rough
estimates of how many requests your infrastructure can handle to help identify bottlenecks.
</p><!--l. 432--><p class="indent" >   Our production service is deployed using Gunicorn, which is a Python WSGI HTTP Server for
UNIX.<span class="footnote-mark"><a 
href="#fn2x0" id="fn2x0-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-19001f2"></a> It
is a pre-fork worker model, which means that it will create a number of worker processes when it starts. Each
worker process can handle the amount of available threads concurrently. This means that the number of
concurrent requests that can be handled by the service is the number of workers multiplied by the number of
threads.
</p><!--l. 439--><p class="indent" >   The number of sync gunicorn workers is determined by the number of CPUs:
</p>
   <div class="math-display" >
<img 
src="main0x.png" alt="workers  = (2 * cpu ) + 1
" class="math-display"  /></div>
<!--l. 444--><p class="indent" >   You can use the logs that you have produced to help measure the time it takes each request to process. We can
then use this to calculate how many requests each worker can handle per second.
</p><!--l. 447--><p class="indent" >   You can use the sleeps in the load tests and the number of virtual users to calculate how many requests are
made per second.
</p><!--l. 449--><p class="indent" >   The service also makes use of RDS. The formula for calculating the amount of concurrent connections RDS
can handle is roughly:
                                                                                                    
                                                                                                    
</p>
   <div class="math-display" >
<img 
src="main1x.png" alt="LEAST   (DBInstanceClassM     emory &#x2215;9531392, 5000 )
" class="math-display"  /></div>
<!--l. 455--><p class="indent" >   Use these calculations to work out the amount of resources required to scale your service to handle the traffic
produced by the tests.
</p>
   <div class="footnotes"><a 
 id="x1-2002x2"></a>
<!--l. 34--><p class="indent" >       <span class="footnote-mark"><a 
href="#fn1x0-bk" id="fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
href="https://pypi.org/project/watchtower/" class="url" ><span 
class="ectt-1000">https://pypi.org/project/watchtower/</span></a></p><a 
 id="x1-19002x4.2"></a>
<!--l. 433--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn2x0-bk" id="fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
href="https://docs.gunicorn.org/en/stable/design.html" class="url" ><span 
class="ectt-1000">https://docs.gunicorn.org/en/stable/design.html</span></a></p>                                             </div>
 
</body></html> 

                                                                                                    


