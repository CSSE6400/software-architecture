Last Updated on 2024/01/04
                                                                                                    

<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>Databases in Applications</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- fn-in,html,htex4ht,xhtml --> 
<meta name="src" content="main.tex" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<link rel="stylesheet" href="https://latex.now.sh/style.css"> 
<link rel="stylesheet" href="/notes.css"> 
<style>body {max-width: 100ch;} 
dl dd {text-align: left}</style> 
</head><body 
>
   <div class="maketitle"><a 
 id="Q1-1-1"></a>
_________________________________________________________________________________________________
<h2 class="titleHead">Databases in Applications</h2>                                                           Software Architecture
   <div class="date" >February 28, 2024</div>                                                                                                                       <div class="author" >Brae Webb &amp; Evan
Hughes</div>
_____________________________________________________________________________________________
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
<a 
 id="x1-2r1"></a>
                                                                                                    
                                                                                                    
<!--l. 21--><p class="noindent" > <a 
href="https://www.oreilly.com/library/view/designing-data-intensive-applications/9781491903063/ch02.html" ><img 
src="images/databases.png" alt="PIC"  
width="525" height="525"  /> </a>
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">A map of data storage techniques from Designing Data-Intensive Applications <span class="cite">[<a 
href="#Xdata-intensive">1</a>]</span>.</span></div><!--tex4ht:label?: x1-2r1 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-10001"></a>This Week</h3>
<!--l. 26--><p class="noindent" >This week our goal is to: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 28--><p class="noindent" >explore the various techniques developers use to store data; and
      </p></li>
      <li class="itemize">
      <!--l. 30--><p class="noindent" >upgrade our todo application to use a local sqlite relational database.</p></li></ul>
                                                                                                    
                                                                                                    
   <h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-20002"></a>Databases and Data Models</h3>
<!--l. 36--><p class="noindent" >Unfortunately, to build interesting software we often need to store and use data. The storage of data introduces a
number of challenges when designing, creating, and maintaining our software. However, not all data storage
techniques are created equal; the choice of data storage model can have a profound impact on our
software&#8217;s complexity and maintainability. In this practical, we want to take a superficial exploration of
our island of data storage models. For a more in-depth treatment of data storage models that is
outside the scope of this course, see Chapter 2 of the <span 
class="Cabin-Italic-tlf-t1-x-x-120">Designing Data-Intensive Applications </span>book
<span class="cite">[<a 
href="#Xdata-intensive">1</a>]</span>.
</p><!--l. 52--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1    </span> <a 
 id="x1-30002.1"></a>Relational Storage</h4>
<!--l. 54--><p class="noindent" >Relational databases are what you have been exposed to the most in your University career &#8212; think MySQL,
Postgres, Oracle DB, etc. This type of database is good at modelling the real world which is often a highly
connected environment.
</p><!--l. 58--><p class="indent" >   Some popular offerings are below:
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 61--><p class="noindent" >MySQL/MariaDB [ Amazon RDS / Amazon Aurora ].
      </p></li>
      <li class="itemize">
      <!--l. 62--><p class="noindent" >Postgres [ Amazon RDS / Amazon Aurora ].
      </p></li>
      <li class="itemize">
      <!--l. 63--><p class="noindent" >SQLite.</p></li></ul>
<!--l. 66--><p class="indent" >   The AWS offerings of these services come in two different types, we have the traditional approach of
server capacity ( x cores, y ram ) and we have a server-less approach. The server-less approach is a
more dynamic database that can scale to large amounts of load when needed though at a cost per
request.
</p><!--l. 71--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">2.1.1    </span> <a 
 id="x1-40002.1.1"></a>ORM</h5>
<!--l. 72--><p class="noindent" >Object Relational Mapping (ORM) is a fairly common tool for programmers to use to make developing with
databases smoother. One fairly prevalent example of this is SQLAlchemy which is a very widely used database
abstraction for python. SQLAlchemy allows us to move to a higher level of abstraction than SQL queries and
perform database actions using standard python code.
</p><!--l. 77--><p class="indent" >   The benefits of ORMs are the ability to model database objects in our existing programming language instead
of having large blocks of SQL text within our source code. The disadvantages come in when we need to do specific
SQL work or where the abstractions cost is greater than the benefits.
                                                                                                    
                                                                                                    
</p><!--l. 80--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2    </span> <a 
 id="x1-50002.2"></a>Wide-Column Storage</h4>
<!--l. 86--><p class="noindent" >Wide-Column databases are a form of NoSQL or non-relational data stores. In these data stores the data model
design is focused more on having efficient queries at the cost of data duplication. A warning to the reader that
these models are not flexible after creation, it is much easier to answer a new use case in a relational
model.
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 93--><p class="noindent" >Apache Cassandra [ Amazon Keyspaces for Cassandra ].
      </p></li>
      <li class="itemize">
      <!--l. 94--><p class="noindent" >Apache HBase.</p></li></ul>
<!--l. 97--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3    </span> <a 
 id="x1-60002.3"></a>Key-Value Storage</h4>
<!--l. 99--><p class="noindent" >Key-Value stores are very popular for cache or remote config use cases, some of the most notable are
Redis and Memcached. These stores allow efficient lookup of values via keys and are usually stored
in-memory.
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 103--><p class="noindent" >Redis [ Amazon ElastiCache for Redis ].
      </p></li>
      <li class="itemize">
      <!--l. 104--><p class="noindent" >Memcached [ Amazon ElastiCache for Memcached].
      </p></li>
      <li class="itemize">
      <!--l. 105--><p class="noindent" >Amazon DynamoDB.
      </p></li>
      <li class="itemize">
      <!--l. 106--><p class="noindent" >Amazon MemoryDB for Redis.</p></li></ul>
                                                                                                    
                                                                                                    
<!--l. 109--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4    </span> <a 
 id="x1-70002.4"></a>Time Series Storage</h4>
<!--l. 115--><p class="noindent" >Time series databases are highly focused storage which is tailored to retrieving results by timestamp ranges. Many
implementations also take advantage of the data model to allow efficient rollover of data and partitioning.
One of the most popular time series databases is Prometheus which is used to store monitoring
metrics.
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 120--><p class="noindent" >Amazon Timestream.
      </p></li>
      <li class="itemize">
      <!--l. 121--><p class="noindent" >TimescaleDB ( Postgres + Addon ).
      </p></li>
      <li class="itemize">
      <!--l. 122--><p class="noindent" >Prometheus.
      </p></li>
      <li class="itemize">
      <!--l. 123--><p class="noindent" >InfluxDB.
      </p></li>
      <li class="itemize">
      <!--l. 124--><p class="noindent" >PostgreSQL</p></li></ul>
<!--l. 127--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5    </span> <a 
 id="x1-80002.5"></a>Document Storage</h4>
<!--l. 129--><p class="noindent" >Document databases are a subset of NoSQL databases with a focus on a flexible data model. MongoDB for
instance allows the user to store JSON documents and perform queries on those documents. One advantage of
document databases is that they match a programmers existing mental model of storing data in formats such as
JSON.
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 134--><p class="noindent" >MongoDB.
      </p></li>
      <li class="itemize">
      <!--l. 135--><p class="noindent" >Apache CouchDB.
                                                                                                    
                                                                                                    
      </p></li>
      <li class="itemize">
      <!--l. 136--><p class="noindent" >Amazon DocumentDB.
      </p></li>
      <li class="itemize">
      <!--l. 137--><p class="noindent" >Amazon DynamoDB.</p></li></ul>
<!--l. 140--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6    </span> <a 
 id="x1-90002.6"></a>Graph Storage</h4>
<!--l. 149--><p class="noindent" >Graph Databases are relational storage with a few enhancements to allow fast neighbour look-ups. These
databases also allow the implementation of graph algorithms to query data.
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 153--><p class="noindent" >Amazon Neptune.
      </p></li>
      <li class="itemize">
      <!--l. 154--><p class="noindent" >Neo4J.
      </p></li>
      <li class="itemize">
      <!--l. 155--><p class="noindent" >Janus Graph.</p></li></ul>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
<a 
 id="x1-9001r2"></a>
                                                                                                    
                                                                                                    
<!--l. 161--><p class="noindent" > <a 
href="https://neo4j.com/developer/example-project/" ><img 
src="images/graph.png" alt="PIC"  
width="525" height="525"  /> </a>
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Graph Database Example from the Neo4J documentation.</span></div><!--tex4ht:label?: x1-9001r2 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-100003"></a>Enhancing the Todo App with Storage</h3>
<!--l. 167--><p class="noindent" >Last week we created a simple web server that can listen on a port and respond to HTTP requests. The endpoints
that we created are all stubs the return a hardcoded JSON response. This week we will add a database to our
application to support persistent storage.
</p><!--l. 171--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-110003.1"></a>Creating a Practical Repository</h4>
<!--l. 172--><p class="noindent" >Navigate to the GitHub Classroom link for this practical provided by your tutor in Slack. As with last week, this will
create a new repository for you in the course organisation. You can now clone this repository to your local
machine or work directly in the browser with GitHub codespaces. This repository will be populated with
our solution to last weeks practical exercise. You may modify this solution or replace it with your
own.
</p><!--l. 183--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-120003.2"></a>Installing the Database Dependencies</h4>
<!--l. 185--><p class="noindent" >We will be using a Python library called SQLAlchemy to interact with our database. This library abstracts the SQL
queries away and allows us to interact with the database using Python objects. We will be using SQLAlchemy
using a package called Flask-SQLAlchemy, a wrapper around SQLAlchemy, that is designed to work with Flask our
WebServer library.
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 190-->
<pre class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-12001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pipenv</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">install</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlalchemy</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 192--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3    </span> <a 
 id="x1-130003.3"></a>Creating the Database and Models</h4>
<!--l. 194--><p class="noindent" >We will be using a database called SQLite for this practical. SQLite is a file-based database which is easy to setup
and use. As the database is isolated to a file, SQLite is a good choice for initial development.
</p><!--l. 198--><p class="indent" >   Now that our dependencies are installed, navigate to the cloned practical directory and create a new folder
within the todo folder called <span 
class="ectt-1200">models</span>. Inside this folder create a new file called <span 
class="ectt-1200">todo.py </span>and a new file called
<span 
class="ectt-1200">__init__.py</span>.
</p><!--l. 202--><p class="indent" >   Inside the <span 
class="ectt-1200">__init__.py </span>file we will add the following code:
</p>
   <div class="framedenv" id="code-1">
<!--l. 204--><pre class="listings" id="listing-2"><span class="label"><a 
 id="x1-13001r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask_sqlalchemy</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">SQLAlchemy</span></span> 
<span class="label"><a 
 id="x1-13002r2"></a></span> 
<span class="label"><a 
 id="x1-13003r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">SQLAlchemy</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span>
 
<span class="label"><a 
 id="x1-13004r4"></a></span></pre>
                                                                                                    
                                                                                                    
   </div>
<!--l. 210--><p class="indent" >   All this file does is setup a new SQLAlchemy object which we will use to interact with our database. In the
<span 
class="ectt-1200">models/todo.py </span>file we will add the following code:
</p>
   <div class="framedenv" id="code-1">
<!--l. 213--><pre class="listings" id="listing-3"><span class="label"><a 
 id="x1-13005r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span> 
<span class="label"><a 
 id="x1-13006r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span> 
<span class="label"><a 
 id="x1-13007r3"></a></span> 
<span class="label"><a 
 id="x1-13008r4"></a></span><span style="color:#006699"><span 
class="ectt-1200">class</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Model</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-13009r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">__tablename__</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">todos</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span> 
<span class="label"><a 
 id="x1-13010r6"></a></span> 
<span class="label"><a 
 id="x1-13011r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">how</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">we</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">define</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">column</span></span><span style="color:#33997E"><span 
class="ectt-1200">,</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">this</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">also</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">primary</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">key</span></span> 
<span class="label"><a 
 id="x1-13012r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">id</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Integer</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">primary_key</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">True</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13013r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">manadatory</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">column</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">of</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">80</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">characters</span></span> 
<span class="label"><a 
 id="x1-13014r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">String</span></span><span style="color:#000000"><span 
class="ectt-1200">(80)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">nullable</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">False</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13015r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">an</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">optional</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">column</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">of</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">120</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">characters</span></span> 
<span class="label"><a 
 id="x1-13016r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">String</span></span><span style="color:#000000"><span 
class="ectt-1200">(120)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">nullable</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">True</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13017r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">column</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">has</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">default</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">value</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">of</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">False</span></span> 
<span class="label"><a 
 id="x1-13018r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Boolean</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">nullable</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">False</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">default</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">False</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13019r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">DateTime</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">nullable</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">True</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13020r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">column</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">has</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">default</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">value</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">which</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">function</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">call</span></span> 
<span class="label"><a 
 id="x1-13021r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">created_at</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">DateTime</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">nullable</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">False</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">default</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">utcnow</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13022r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">column</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">has</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">default</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">value</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">which</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">function</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">call</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">and</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">also</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">updates</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">on</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">update</span></span> 
<span class="label"><a 
 id="x1-13023r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">updated_at</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">Column</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">DateTime</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">nullable</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">False</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">default</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">utcnow</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">onupdate</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">utcnow</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13024r20"></a></span> 
<span class="label"><a 
 id="x1-13025r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">This</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">is</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">helper</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">method</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">convert</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">model</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">dictionary</span></span> 
<span class="label"><a 
 id="x1-13026r22"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to_dict</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-13027r23"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13028r24"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">id</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#006699"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13029r25"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">title</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13030r26"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">description</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13031r27"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">completed</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13032r28"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">isoformat</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">else</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13033r29"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">created_at</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">created_at</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">isoformat</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">created_at</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">else</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13034r30"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">updated_at</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">updated_at</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">isoformat</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">updated_at</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">else</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-13035r31"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-13036r32"></a></span> 
<span class="label"><a 
 id="x1-13037r33"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">__repr__</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-13038r34"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">f</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">&#x003C;</span></span><span style="color:#669900"><span 
class="ectt-1200">Todo</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">{</span></span><span style="color:#669900"><span 
class="ectt-1200">self</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">id</span></span><span style="color:#669900"><span 
class="ectt-1200">}</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">{</span></span><span style="color:#669900"><span 
class="ectt-1200">self</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">title</span></span><span style="color:#669900"><span 
class="ectt-1200">}&#x003E;</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span>
 
<span class="label"><a 
 id="x1-13039r35"></a></span></pre>
   </div>
<!--l. 250--><p class="indent" >   The above code is doing a lot of the heavy lifting for us in our database table generation, have a look at the
comments above to see what each line is doing.
</p><!--l. 254--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4    </span> <a 
 id="x1-140003.4"></a>Configuring the Database</h4>
<!--l. 256--><p class="noindent" >Now that we have defined our database schema using an ORM, we need to configure our application to use the
database. Open the <span 
class="ectt-1200">todo/__init__.py </span>file and change the code to the following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 260--><pre class="listings" id="listing-4"><span class="label"><a 
 id="x1-14001r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Flask</span></span> 
<span class="label"><a 
 id="x1-14002r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask_sqlalchemy</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">SQLAlchemy</span></span> 
<span class="label"><a 
 id="x1-14003r3"></a></span> 
<span class="label"><a 
 id="x1-14004r4"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-14005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Flask</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">__name__</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-14006r6"></a></span> 
<span class="label"><a 
 id="x1-14007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">config</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">SQLALCHEMY_DATABASE_URI</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">sqlite</span></span><span style="color:#669900"><span 
class="ectt-1200">:///</span></span><span style="color:#669900"><span 
class="ectt-1200">db</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">sqlite</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14008r8"></a></span> 
<span class="label"><a 
 id="x1-14009r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Load</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">models</span></span> 
<span class="label"><a 
 id="x1-14010r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">models</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span> 
<span class="label"><a 
 id="x1-14011r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">models</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span> 
<span class="label"><a 
 id="x1-14012r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">init_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-14013r13"></a></span> 
<span class="label"><a 
 id="x1-14014r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Create</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">database</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">tables</span></span> 
<span class="label"><a 
 id="x1-14015r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">with</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">app_context</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-14016r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">create_all</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-14017r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">commit</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-14018r18"></a></span> 
<span class="label"><a 
 id="x1-14019r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Register</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">blueprints</span></span> 
<span class="label"><a 
 id="x1-14020r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">views</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">routes</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">api</span></span> 
<span class="label"><a 
 id="x1-14021r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">register_blueprint</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-14022r22"></a></span> 
<span class="label"><a 
 id="x1-14023r23"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">app</span></span>
 
<span class="label"><a 
 id="x1-14024r24"></a></span></pre>
   </div>
<!--l. 286--><p class="indent" >   In the above we set a default location, defined as a URI, for our database. As we using SQLite we can set the
database to be a file on the file system. In production systems, you would set this to a URI that defines the
credentials and hostname of your database server. In latter practicals, we will get experience using more complex
URIs.
</p><!--l. 291--><p class="indent" >   If we run our application now, we will see that the database file has been created for us.  </p><div class="framedenv" id="shaded*-1">
   <!--l. 292-->
<pre class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-14025r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pipenv</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">p</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">6400</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"><span 
class="ectt-1200">debug</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
                                                                                                    
                                                                                                    
<!--l. 296--><p class="indent" >   Your project structure should have a least the follow structure (there may be additional files):
</p>
   <div class="framedenv" id="code-1">
<!--l. 298--><pre class="listings" id="listing-6"><span class="label"><a 
 id="x1-14026r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">README</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">md</span></span> 
<span class="label"><a 
 id="x1-14027r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Pipfile</span></span> 
<span class="label"><a 
 id="x1-14028r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Pipfile</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">lock</span></span> 
<span class="label"><a 
 id="x1-14029r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">endpoints</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">http</span></span> 
<span class="label"><a 
 id="x1-14030r5"></a></span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">instance</span></span> 
<span class="label"><a 
 id="x1-14031r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlite</span></span> 
<span class="label"><a 
 id="x1-14032r7"></a></span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span> 
<span class="label"><a 
 id="x1-14033r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">__init__</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">py</span></span> 
<span class="label"><a 
 id="x1-14034r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">views</span></span> 
<span class="label"><a 
 id="x1-14035r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">routes</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">py</span></span> 
<span class="label"><a 
 id="x1-14036r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">models</span></span> 
<span class="label"><a 
 id="x1-14037r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">__init__</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">py</span></span> 
<span class="label"><a 
 id="x1-14038r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">|</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">--</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">py</span></span>
 
<span class="label"><a 
 id="x1-14039r14"></a></span></pre>
   </div>
<!--l. 314--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.5    </span> <a 
 id="x1-150003.5"></a>Inspecting the Database</h4>
<!--l. 316--><p class="noindent" >We can use the <span 
class="ectt-1200">sqlite3 </span>command line tool to inspect the database. Open a terminal and navigate to the root of
your project. Then run the following command:
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 320-->
<pre class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-15001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sqlite3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">instance</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">sqlite</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
   <div class="tcolorbox tcolorbox" id="tcolobox-1"> 
<div class="tcolorbox-title">
<!--l. 325--><p class="indent" >   Info</p></div> 
<div class="tcolorbox-content"><!--l. 325--><p class="noindent" >Most platforms including MacOS, WSL2, and most Linux environments come with SQLite installed.
If you get an error running the above command, you may have to install SQLite.  </p> 
</div> 
</div>
<!--l. 327--><p class="indent" >   This will open the SQLite command line tool and connect to the database file. We can then run the following
command to see the tables in our database:
</p>
   <div class="framedenv" id="code-1">
<!--l. 330--><pre class="listings" id="listing-8"><span class="label"><a 
 id="x1-15002r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">tables</span></span>
 
<span class="label"><a 
 id="x1-15003r2"></a></span></pre>
   </div>
<!--l. 334--><p class="indent" >   This will show us the tables in our database. We can then run the following command to see the schema of our
table:
</p>
   <div class="framedenv" id="code-1">
<!--l. 337--><pre class="listings" id="listing-9"><span class="label"><a 
 id="x1-15004r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">schema</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span>
 
<span class="label"><a 
 id="x1-15005r2"></a></span></pre>
   </div>
<!--l. 341--><p class="indent" >   This will show us the columns in our table. We can then run the following command to see the data in our
table:
</p>
   <div class="framedenv" id="code-1">
<!--l. 344--><pre class="listings" id="listing-10"><span class="label"><a 
 id="x1-15006r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">SELECT</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">*</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">FROM</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">;</span></span>
 
<span class="label"><a 
 id="x1-15007r2"></a></span></pre>
   </div>
<!--l. 348--><p class="indent" >   This should initially show us no output, indicating that the table is currently empty. We can then run the
following command to exit the SQLite command line tool:
</p>
   <div class="framedenv" id="code-1">
                                                                                                    
                                                                                                    
<!--l. 351--><pre class="listings" id="listing-11"><span class="label"><a 
 id="x1-15008r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">exit</span></span>
 
<span class="label"><a 
 id="x1-15009r2"></a></span></pre>
   </div>
<!--l. 355--><p class="indent" >   You should notice that our table is called todos and not todo because we specified todos with the
<span 
class="ectt-1200">__tablename__ </span>attribute.
</p><!--l. 358--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.6    </span> <a 
 id="x1-160003.6"></a>Using the Database</h4>
<!--l. 360--><p class="noindent" >Now that we have a database intergrated into our application, we will modify our endpoints to take advantage of
it.
</p><!--l. 363--><p class="indent" >   Open the <span 
class="ectt-1200">todo/views/routes.py </span>file and add the following imports to the top of the file:
</p>
   <div class="framedenv" id="code-1">
<!--l. 365--><pre class="listings" id="listing-12"><span class="label"><a 
 id="x1-16001r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">flask</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Blueprint</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span> 
<span class="label"><a 
 id="x1-16002r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">models</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span> 
<span class="label"><a 
 id="x1-16003r3"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">models</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span> 
<span class="label"><a 
 id="x1-16004r4"></a></span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span>
 
<span class="label"><a 
 id="x1-16005r5"></a></span></pre>
   </div>
<!--l. 372--><p class="indent" >   Open the <span 
class="ectt-1200">todo/views/routes.py </span>file and change the <span 
class="ectt-1200">get_todos </span>endpoint to the following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 374--><pre class="listings" id="listing-13"><span class="label"><a 
 id="x1-16006r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">@api</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">route</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">todos</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">methods</span></span><span style="color:#000000"><span 
class="ectt-1200">=[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">GET</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">])</span></span> 
<span class="label"><a 
 id="x1-16007r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">get_todos</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16008r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">query</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#006699"><span 
class="ectt-1200">all</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-16009r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">result</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[]</span></span> 
<span class="label"><a 
 id="x1-16010r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todos</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16011r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">result</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">append</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">to_dict</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16012r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">result</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-16013r8"></a></span></pre>
   </div>
<!--l. 384--><p class="indent" >   This will query the database for all the todos and return them as JSON. We can then change the <span 
class="ectt-1200">get_todo</span>
endpoint to the following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 387--><pre class="listings" id="listing-14"><span class="label"><a 
 id="x1-16014r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">@api</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">route</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">todos</span></span><span style="color:#669900"><span 
class="ectt-1200">/&#x003C;</span></span><span style="color:#669900"><span 
class="ectt-1200">int</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"><span 
class="ectt-1200">todo_id</span></span><span style="color:#669900"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">methods</span></span><span style="color:#000000"><span 
class="ectt-1200">=[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">GET</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">])</span></span> 
<span class="label"><a 
 id="x1-16015r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">get_todo</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16016r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">query</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16017r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16018r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">({</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">error</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">Todo</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">not</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">found</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">})</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">404</span></span> 
<span class="label"><a 
 id="x1-16019r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">to_dict</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-16020r7"></a></span></pre>
   </div>
<!--l. 396--><p class="indent" >   Now we have modified these endpoints to use the database &#8212; let&#8217;s test that our application is still functioning
correctly. Restart your webserver and navigate to the <span 
class="ectt-1200">/api/v1/todos </span>endpoint. You should see the following
JSON response:
</p>
   <div class="framedenv" id="code-1">
<!--l. 400--><pre class="listings" id="listing-15"><span class="label"><a 
 id="x1-16021r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span>
 
<span class="label"><a 
 id="x1-16022r2"></a></span></pre>
   </div>
<!--l. 404--><p class="indent" >   Of course our API does not have any todo items in it yet. We will now add the ability to insert todo items to
our database. Open the <span 
class="ectt-1200">todo/views/routes.py </span>file and change the <span 
class="ectt-1200">create_todo </span>endpoint to the
following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 408--><pre class="listings" id="listing-16"><span class="label"><a 
 id="x1-16023r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">@api</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">route</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">todos</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">methods</span></span><span style="color:#000000"><span 
class="ectt-1200">=[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">POST</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">])</span></span> 
<span class="label"><a 
 id="x1-16024r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_todo</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16025r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span> 
<span class="label"><a 
 id="x1-16026r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">title</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16027r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">description</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16028r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">completed</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">False</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16029r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16030r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16031r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">datetime</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">fromisoformat</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16032r10"></a></span> 
<span class="label"><a 
 id="x1-16033r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Adds</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">a</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">new</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">record</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">database</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">or</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">will</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">update</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">an</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">existing</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">record</span></span> 
<span class="label"><a 
 id="x1-16034r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">add</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16035r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Commits</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">changes</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">database</span></span><span style="color:#33997E"><span 
class="ectt-1200">,</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">this</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">must</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">be</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">called</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">for</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">changes</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">be</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">saved</span></span> 
<span class="label"><a 
 id="x1-16036r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">commit</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-16037r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">to_dict</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">201</span></span>
 
<span class="label"><a 
 id="x1-16038r16"></a></span></pre>
                                                                                                    
                                                                                                    
   </div>
<!--l. 426--><p class="indent" >   This endpoint now allows us create a todo item in the database. Test this endpoint by going to endpoints.http
(or your API query tool of choice) and running the POST request. You should see the following response (with
different created_at and updated_at values):
</p>
   <div class="framedenv" id="code-1">
<!--l. 430--><pre class="listings" id="listing-17"><span class="label"><a 
 id="x1-16039r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-16040r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16041r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">Test</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16042r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">This</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">test</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16043r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">false</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16044r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">null</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16045r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">created_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"2023-02-27</span></span><span style="color:#000000"><span 
class="ectt-1200">T12</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00.000000</span></span><span style="color:#000000"><span 
class="ectt-1200">Z</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16046r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">updated_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"2023-02-27</span></span><span style="color:#000000"><span 
class="ectt-1200">T12</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00.000000</span></span><span style="color:#000000"><span 
class="ectt-1200">Z</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-16047r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-16048r10"></a></span></pre>
   </div>
<!--l. 442--><p class="indent" >   Now if we go to our <span 
class="ectt-1200">/api/v1/todos </span>endpoint we should see the todo item we just created:
</p>
   <div class="framedenv" id="code-1">
<!--l. 444--><pre class="listings" id="listing-18"><span class="label"><a 
 id="x1-16049r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">[</span></span> 
<span class="label"><a 
 id="x1-16050r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-16051r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16052r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">Test</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16053r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">This</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">test</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16054r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">false</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16055r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">null</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16056r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">created_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"2023-02-27</span></span><span style="color:#000000"><span 
class="ectt-1200">T12</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00.000000</span></span><span style="color:#000000"><span 
class="ectt-1200">Z</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16057r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">updated_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"2023-02-27</span></span><span style="color:#000000"><span 
class="ectt-1200">T12</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00.000000</span></span><span style="color:#000000"><span 
class="ectt-1200">Z</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-16058r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-16059r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">]</span></span>
 
<span class="label"><a 
 id="x1-16060r12"></a></span></pre>
   </div>
<!--l. 458--><p class="indent" >   Now let&#8217;s add the remaining endpoints. Change the <span 
class="ectt-1200">update_todo </span>endpoint to the following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 461--><pre class="listings" id="listing-19"><span class="label"><a 
 id="x1-16061r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">@api</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">route</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">todos</span></span><span style="color:#669900"><span 
class="ectt-1200">/&#x003C;</span></span><span style="color:#669900"><span 
class="ectt-1200">int</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"><span 
class="ectt-1200">todo_id</span></span><span style="color:#669900"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">methods</span></span><span style="color:#000000"><span 
class="ectt-1200">=[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">PUT</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">])</span></span> 
<span class="label"><a 
 id="x1-16062r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">update_todo</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16063r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">query</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16064r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16065r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">({</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">error</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">Todo</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">not</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">found</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">})</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">404</span></span> 
<span class="label"><a 
 id="x1-16066r6"></a></span> 
<span class="label"><a 
 id="x1-16067r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">title</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16068r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">description</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16069r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">completed</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16070r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">request</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16071r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">commit</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-16072r12"></a></span> 
<span class="label"><a 
 id="x1-16073r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">to_dict</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-16074r14"></a></span></pre>
   </div>
<!--l. 477--><p class="indent" >   This endpoint will update a todo item in the database. Let&#8217;s test this endpoint by going to our endpoints.http
and running the PUT request. You should see the following response:
</p>
   <div class="framedenv" id="code-1">
<!--l. 481--><pre class="listings" id="listing-20"><span class="label"><a 
 id="x1-16075r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-16076r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16077r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">title</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">Updated</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Test</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16078r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">This</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">an</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">updated</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">test</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16079r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">completed</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">false</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16080r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">deadline_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">null</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16081r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">created_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"2023-02-27</span></span><span style="color:#000000"><span 
class="ectt-1200">T12</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00.000000</span></span><span style="color:#000000"><span 
class="ectt-1200">Z</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-16082r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">updated_at</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"2023-02-27</span></span><span style="color:#000000"><span 
class="ectt-1200">T12</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"><span 
class="ectt-1200">00.000000</span></span><span style="color:#000000"><span 
class="ectt-1200">Z</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-16083r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-16086r12"></a></span></pre>
   </div>
<!--l. 494--><p class="indent" >   To implement delete functionalitty, we will use the HTTP DELETE method and the delete .method of the
database session. Open the <span 
class="ectt-1200">todo/views/routes.py </span>file and change the <span 
class="ectt-1200">delete_todo </span>endpoint to the
following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 497--><pre class="listings" id="listing-21"><span class="label"><a 
 id="x1-16087r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">@api</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">route</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">todos</span></span><span style="color:#669900"><span 
class="ectt-1200">/&#x003C;</span></span><span style="color:#669900"><span 
class="ectt-1200">int</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"><span 
class="ectt-1200">todo_id</span></span><span style="color:#669900"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">methods</span></span><span style="color:#000000"><span 
class="ectt-1200">=[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">DELETE</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">])</span></span> 
<span class="label"><a 
 id="x1-16088r2"></a></span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">delete_todo</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16089r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">query</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo_id</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16090r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-16091r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">({})</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200</span></span> 
<span class="label"><a 
 id="x1-16092r6"></a></span> 
<span class="label"><a 
 id="x1-16093r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">delete</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-16094r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">commit</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-16095r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">jsonify</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">to_dict</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200</span></span>
 
<span class="label"><a 
 id="x1-16096r10"></a></span></pre>
   </div>
<!--l. 509--><p class="indent" >   We now have a set of endpoints that can perform the CRUD operations of our API but some functionality is
missing. We are gonna add that functionality after setting up some tests to help us do <span 
class="Cabin-Bold-tlf-t1-x-x-120">Test Driven</span>
<span 
class="Cabin-Bold-tlf-t1-x-x-120">Development</span>.
</p><!--l. 512--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-170004"></a>Testing the API</h3>
                                                                                                    
                                                                                                    
<!--l. 514--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1    </span> <a 
 id="x1-180004.1"></a>Setting up the testing environment</h4>
<!--l. 516--><p class="noindent" >In the project, you will have a <span 
class="ectt-1200">tests </span>folder. This contains <span 
class="ectt-1200">test_todo.py </span>which has a range of provided tests for
the todo endpoints. However, we need to setup a few components to make it work.
</p><!--l. 520--><p class="indent" >   Inside the <span 
class="ectt-1200">tests </span>folder create a <span 
class="ectt-1200">base.py </span>file. Inside the <span 
class="ectt-1200">base.py </span>file add the following code:
</p>
   <div class="framedenv" id="code-1">
<!--l. 522--><pre class="listings" id="listing-22"><span class="label"><a 
 id="x1-18001r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span> 
<span class="label"><a 
 id="x1-18002r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">unittest</span></span> 
<span class="label"><a 
 id="x1-18003r3"></a></span> 
<span class="label"><a 
 id="x1-18004r4"></a></span> 
<span class="label"><a 
 id="x1-18005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">class</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">TodoTest</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">unittest</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">TestCase</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-18006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">setUp</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-18007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">={</span></span> 
<span class="label"><a 
 id="x1-18008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">SQLALCHEMY_DATABASE_URI</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">sqlite</span></span><span style="color:#669900"><span 
class="ectt-1200">:///:</span></span><span style="color:#669900"><span 
class="ectt-1200">memory</span></span><span style="color:#669900"><span 
class="ectt-1200">:</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span> 
<span class="label"><a 
 id="x1-18009r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">TESTING</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">True</span></span> 
<span class="label"><a 
 id="x1-18010r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">})</span></span> 
<span class="label"><a 
 id="x1-18011r11"></a></span> 
<span class="label"><a 
 id="x1-18012r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">client</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">test_client</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-18013r13"></a></span> 
<span class="label"><a 
 id="x1-18014r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">assertDictSubset</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">expected_subset</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">dict</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">whole</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">dict</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-18015r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">for</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">key</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">value</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">expected_subset</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">items</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-18016r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">assertEqual</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">whole</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">key</span></span><span style="color:#000000"><span 
class="ectt-1200">],</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">value</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-18017r17"></a></span></pre>
   </div>
<!--l. 542--><p class="indent" >   This base class is what we will use to help setup our tests and provide an assertion helper method. The <span 
class="ectt-1200">setUp</span>
method is called before each test and is used to initialise the in-memory database. The <span 
class="ectt-1200">assertDictSubset</span>
method is a helper method that we will use to compare the todo items we get from the API with the todo items
we expect to get from the API.
</p><!--l. 546--><p class="indent" >   As you can see we use a slight modification to the <span 
class="ectt-1200">create_app </span>function. We are passing in a dictionary of
config overrides. This allows us to override the config values for the testing environment.
</p><!--l. 550--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2    </span> <a 
 id="x1-190004.2"></a>Prepping the config for testing</h4>
<!--l. 552--><p class="noindent" >Open the <span 
class="ectt-1200">todo/__init__.py </span>file and adjust the <span 
class="ectt-1200">create_app </span>function to the following:
</p>
   <div class="framedenv" id="code-1">
<!--l. 554--><pre class="listings" id="listing-23"><span class="label"><a 
 id="x1-19001r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">None</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-19002r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Flask</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">__name__</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-19003r3"></a></span> 
<span class="label"><a 
 id="x1-19004r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">config</span></span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">SQLALCHEMY_DATABASE_URI</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">sqlite</span></span><span style="color:#669900"><span 
class="ectt-1200">:///</span></span><span style="color:#669900"><span 
class="ectt-1200">db</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">sqlite</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-19005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">if</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-19006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">config</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">update</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">config_overrides</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-19007r7"></a></span> 
<span class="label"><a 
 id="x1-19008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Load</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">models</span></span> 
<span class="label"><a 
 id="x1-19009r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">models</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">db</span></span> 
<span class="label"><a 
 id="x1-19010r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">models</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">todo</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Todo</span></span> 
<span class="label"><a 
 id="x1-19011r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">init_app</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-19012r12"></a></span> 
<span class="label"><a 
 id="x1-19013r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Create</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">database</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">tables</span></span> 
<span class="label"><a 
 id="x1-19014r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">with</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">app_context</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-19015r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">create_all</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-19016r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">db</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">session</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">commit</span></span><span style="color:#000000"><span 
class="ectt-1200">()</span></span> 
<span class="label"><a 
 id="x1-19017r17"></a></span> 
<span class="label"><a 
 id="x1-19018r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">Register</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">the</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">blueprints</span></span> 
<span class="label"><a 
 id="x1-19019r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">views</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">routes</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">api</span></span> 
<span class="label"><a 
 id="x1-19020r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">app</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">register_blueprint</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">api</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-19021r21"></a></span> 
<span class="label"><a 
 id="x1-19022r22"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">return</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">app</span></span>
 
<span class="label"><a 
 id="x1-19023r23"></a></span></pre>
   </div>
<!--l. 579--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3    </span> <a 
 id="x1-200004.3"></a>Writing our first tests</h4>
<!--l. 581--><p class="noindent" >Now we will write our first tests. Open the <span 
class="ectt-1200">tests </span>folder and create a <span 
class="ectt-1200">test_health.py </span>file. Add the following
code:
</p>
   <div class="framedenv" id="code-1">
<!--l. 585--><pre class="listings" id="listing-24"><span class="label"><a 
 id="x1-20001r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">tests</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">base</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">import</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">TodoTest</span></span> 
<span class="label"><a 
 id="x1-20002r2"></a></span> 
<span class="label"><a 
 id="x1-20003r3"></a></span> 
<span class="label"><a 
 id="x1-20004r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">class</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">TestHealth</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">TodoTest</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-20005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">def</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">test_health</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-20006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">response</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">client</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">get</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">api</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">v1</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">health</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-20007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">assertEqual</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">response</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">status_code</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">200)</span></span> 
<span class="label"><a 
 id="x1-20008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">self</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">assertEqual</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">response</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">json</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">status</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#669900"><span 
class="ectt-1200">ok</span></span><span style="color:#669900"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">})</span></span>
 
<span class="label"><a 
 id="x1-20011r11"></a></span></pre>
   </div>
<!--l. 597--><p class="indent" >   This test will make a GET request to the <span 
class="ectt-1200">/api/v1/health </span>endpoint and check </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 599--><p class="noindent" >that the response is a 200 status code; and
                                                                                                    
                                                                                                    
      </p></li>
      <li class="itemize">
      <!--l. 600--><p class="noindent" >that the response is a JSON object with the key <span 
class="ectt-1200">status </span>and the value <span 
class="ectt-1200">ok</span>.</p></li></ul>
<!--l. 603--><p class="indent" >   To run this test stop your server, if it is running, and run the following command:
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 605-->
<pre class="lstlisting" id="listing-25"><span class="label"><a 
 id="x1-20012r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pipenv</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">python3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">m</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">unittest</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">tests</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">test_health</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">py</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 607--><p class="indent" >   You should see the following output:
</p>
   <div class="framedenv" id="code-1">
<!--l. 609--><pre class="listings" id="listing-26"><span class="label"><a 
 id="x1-20013r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">&#x003E;&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pipenv</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">python3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">m</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">unittest</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">tests</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">test_health</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">py</span></span> 
<span class="label"><a 
 id="x1-20014r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">....</span></span> 
<span class="label"><a 
 id="x1-20015r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">----------------------------------------------------------------------</span></span> 
<span class="label"><a 
 id="x1-20016r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Ran</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">tests</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">in</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0.011</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span> 
<span class="label"><a 
 id="x1-20017r5"></a></span> 
<span class="label"><a 
 id="x1-20018r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">OK</span></span>
 
<span class="label"><a 
 id="x1-20019r7"></a></span></pre>
   </div>
<!--l. 618--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4    </span> <a 
 id="x1-210004.4"></a>Test Driven Development</h4>
<!--l. 620--><p class="noindent" >Now you&#8217;ve created a test for the health endpoint and run it. To run the suite of provided tests, use the following
command:
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 624-->
<pre class="lstlisting" id="listing-27"><span class="label"><a 
 id="x1-21001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">pipenv</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">run</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">python3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">m</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">unittest</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">discover</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">tests</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 626--><p class="indent" >   If you&#8217;ve used only the code we&#8217;ve provided, you should see some of the tests fail.
</p><!--l. 629--><p class="indent" >   The tests are based on the specification from week one, we would like you to change your API to make the
tests pass.
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-2">     
<div class="tcolorbox-title">
<!--l. 634--><p class="indent" >   Hint</p></div> 
<div class="tcolorbox-content"><!--l. 634--><p class="noindent" >To check if the request is a JSON request you can use the <span 
class="ectt-1200">request.is_json </span>method.  </p> 
</div> 
</div>
<!--l. 636--><p class="indent" >   If you get stuck feel free to ask your peers / staff for help.
</p><!--l. 638--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5    </span> <a 
 id="x1-220005"></a>Finishing Up</h3>
<!--l. 640--><p class="noindent" >We now have a working API which we can use to create, read, update, and delete todo items. We can also use the
API to: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 643--><p class="noindent" >mark todo items as completed;
                                                                                                    
                                                                                                    
      </p></li>
      <li class="itemize">
      <!--l. 644--><p class="noindent" >filter todo items by whether they are completed or not; and
      </p></li>
      <li class="itemize">
      <!--l. 645--><p class="noindent" >filter todo items by whether they are within the next N days.</p></li></ul>
<!--l. 648--><p class="indent" >   Next week we will dockerise our API and use docker-compose to run our API and a database within
containers.
</p><!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-23000"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xdata-intensive"></a>M.&#x00A0;Kleppmann,  <span 
class="Cabin-Italic-tlf-t1-x-x-120">Designing  Data-Intensive  Applications:  The  big  ideas  behind  reliable,  scalable,  and</span>
   <span 
class="Cabin-Italic-tlf-t1-x-x-120">maintainable systems</span>. O&#8217;Reilly Media, Inc., March 2017.
</p>
   </div>
    
</body></html> 

                                                                                                    


