Last Updated on 2025/03/20
                                                                                                    

<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>Getting Started with the Cloud</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- fn-in,html,htex4ht,xhtml --> 
<meta name="src" content="main.tex" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<link rel="stylesheet" href="https://latex.now.sh/style.css"> 
<link rel="stylesheet" href="/notes.css"> 
<style>body {max-width: 100ch;} 
dl dd {text-align: left}</style> 
</head><body 
>
   <div class="maketitle"><a 
 id="Q1-1-1"></a>
_________________________________________________________________________________________________
<h2 class="titleHead">Getting Started with the Cloud</h2>                                                  Software Architecture
   <div class="date" >March 18, 2025</div>                                                                                          <div class="author" >Brae Webb &amp; Richard Thomas &amp; Evan
Hughes</div>
_____________________________________________________________________________________________
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
<div class="center" 
>
<!--l. 14--><p class="noindent" >
</p><!--l. 15--><p class="noindent" ><img 
src="images/hextriscloud.png" alt="PIC"  
width="28" height="28"  /></p></div>
</div><hr class="endfigure" />
   <div class="tcolorbox tcolorbox" id="tcolobox-1">     
<div class="tcolorbox-title">
<!--l. 21--><p class="indent" >   Aside</p></div> 
<div class="tcolorbox-content"><!--l. 21--><p class="noindent" >Github       Classroom       links       for       this       practical       can       be       found       on       Edstem       
<a 
href="https://edstem.org/au/courses/21491/discussion/2429006" class="url" ><span 
class="ectt-1200">https://edstem.org/au/courses/21491/discussion/2429006</span></a> </p> 
</div> 
</div>
   
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Before Class</h3>
<!--l. 25--><p class="noindent" > <a 
href="https://learn.hashicorp.com/tutorials/terraform/install-cli" >Install Terraform</a><span class="footnote-mark"><a 
href="#fn1x0" id="fn1x0-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-1001f1"></a>
<span 
class="Cabin-Italic-tlf-t1-x-x-120">before </span>your practical class. Also install the Terraform plugin for your IDE.
   
</p>
   <h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-20001"></a>This Week</h3>
<!--l. 30--><p class="noindent" >This week our goal is to get acquainted with AWS Academy. We use AWS Academy to learn how to deploy and
manage infrastructure with AWS. Additionally, AWS Academy will be used to develop the Cloud Infrastructure
assignment. If you have not already enrolled in the AWS Academy courses, you need to do so now.
</p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 35--><p class="noindent" >AWS Academy <span 
class="Cabin-Bold-tlf-t1-x-x-120">Practicals </span>Learner Lab [ <a 
href="https://awsacademy.instructure.com/courses/110995" >110995</a>]
      </p></li>
      <li class="itemize">
      <!--l. 36--><p class="noindent" >AWS Academy <span 
class="Cabin-Bold-tlf-t1-x-x-120">Assignment </span>Learner Lab [ <a 
href="https://awsacademy.instructure.com/courses/112082" >112082</a>]
      </p></li>
      <li class="itemize">
      <!--l. 37--><p class="noindent" >AWS Academy Cloud Foundations [ <a 
href="https://awsacademy.instructure.com/courses/110989" >110989</a>]
      </p></li>
      <li class="itemize">
      <!--l. 38--><p class="noindent" >AWS Academy Cloud Architecting [ <a 
href="https://awsacademy.instructure.com/courses/110993" >110993</a>]
      </p></li>
      <li class="itemize">
      <!--l. 39--><p class="noindent" >AWS Academy Cloud Developing [ <a 
href="https://awsacademy.instructure.com/courses/110994" >110994</a>]</p></li></ul>
<!--l. 42--><p class="noindent" >This week you will learn how to: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 45--><p class="noindent" >Navigate the AWS Academy interface, if you have not done so already.
                                                                                                    
                                                                                                    
      </p></li>
      <li class="itemize">
      <!--l. 46--><p class="noindent" >Enter the AWS Console from an AWS Academy lab.
      </p></li>
      <li class="itemize">
      <!--l. 47--><p class="noindent" >Provision an EC2 instance that deploys a simple static website.</p></li></ul>
<!--l. 50--><p class="noindent" >We will then start using an Infrastructure as Code tool, specifically, Terraform, to deploy the static website instead
of using the AWS Console. This week you will also learn how to: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 56--><p class="noindent" >Authenticate Terraform to use the AWS Learner Lab.
      </p></li>
      <li class="itemize">
      <!--l. 57--><p class="noindent" >Configure a single server website in Terraform and deploy.
      </p></li>
      <li class="itemize">
      <!--l. 58--><p class="noindent" >Create a Terraform module for deploying arbitrary single server websites.</p></li></ul>
   
   <h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-30002"></a>AWS Academy</h3>
<!--l. 62--><p class="noindent" >AWS Academy is an educational platform to teach you how to use AWS services. In this course, we will be using it
in two ways:
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-3002x1">
      <!--l. 65--><p class="noindent" >The AWS Cloud Foundations, Cloud Architecting, and Cloud Developing courses are supplementary
      material to help cement your ability to use AWS. You are encouraged to work your way through at
      least the AWS Cloud Foundations and Cloud Architecting courses.
      </p></li>
<li 
  class="enumerate" id="x1-3004x2">
      <!--l. 67--><p class="noindent" >The  AWS  Learner  Lab  (  <a 
href="https://awsacademy.instructure.com/courses/110995" >110995</a>)  provides  access  to  an  environment  which  will  be  used  in  these
      practicals  to  learn  AWS.  A  separate  Learn  Lab  (  <a 
href="https://awsacademy.instructure.com/courses/112082" >112082</a>)  will  be  used  to  develop  your  Cloud
      Infrastructure assignment. Remember that you have a $50 USD budget for <span 
class="Cabin-Italic-tlf-t1-x-x-120">each </span>Learner Lab. Once
      you have spent your budget, you will not be able to use the Learner Lab.</p></li></ol>
   
                                                                                                    
                                                                                                    
   <h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-40003"></a>Enrol in AWS Academy</h3>
<!--l. 77--><p class="noindent" >
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-4002x1">
      <!--l. 79--><p class="noindent" >Set up your AWS Academy account by responding to your email invitation and clicking <span 
class="Cabin-Bold-tlf-t1-x-x-120">Get Started</span>.
      The email invitation will come from AWS Academy. Check your junk/spam folders.
      </p><!--l. 83--><p class="noindent" >&#x00A0;&#x00A0;            <img 
src="images/email-invite.png" alt="PIC"  
width="378" height="141"  />
      </p></li>
<li 
  class="enumerate" id="x1-4004x2">
      <!--l. 86--><p class="noindent" >Go to <a 
href="https://www.awsacademy.com/vforcesite/LMS_Login" class="url" ><span 
class="ectt-1200">https://www.awsacademy.com/vforcesite/LMS_Login</span></a> to login.
           </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-4006x1">
           <!--l. 88--><p class="noindent" >Press <span 
class="Cabin-Bold-tlf-t1-x-x-120">Student Login</span>.
           </p></li>
<li 
  class="enumerate" id="x1-4008x2">
           <!--l. 89--><p class="noindent" >Use the email address that received the email invitation.</p></li></ol>
      <!--l. 92--><p class="noindent" >&#x00A0;&#x00A0;          <img 
src="images/labs-login1.png" alt="PIC"  
width="257" height="257"  /> &#x00A0;      <img 
src="images/labs-login2.png" alt="PIC"  
width="257" height="257"  /></p></li></ol>
   
   <h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-50004"></a>Exploring the Interface</h3>
   <div class="tcolorbox tcolorbox" id="tcolobox-2">     
<div class="tcolorbox-title">
<!--l. 100--><p class="indent" >   Aside</p></div> 
<div class="tcolorbox-content"><!--l. 100--><p class="noindent" >We will just be looking at the Learner Lab today, please ask on the Ed Discussion board if you need
help using the supplementary AWS Academy courses. </p> 
</div> 
</div>
<!--l. 102--><p class="noindent" >Enter the Learner Lab via the following steps.
</p><!--l. 104--><p class="indent" >
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-5002x1">
      <!--l. 106--><p class="noindent" >Once you have enrolled in the course, you should see the course page.
      </p><!--l. 108--><p class="noindent" ><img 
src="images/academy-homepage.png" alt="PIC"  
width="498" height="-887"  />
      </p></li>
<li 
  class="enumerate" id="x1-5004x2">
      <!--l. 110--><p class="noindent" >Navigate to the <span 
class="ectt-1200">Modules </span>tab and select the link for &#8220;Launch AWS Academy Learner Lab&#8221;. You will
      need to accept the AWS Learner Lab terms and conditions to be able to launch learner lab. You may
      also open and browse the &#8220;AWS Academy Learner Lab Student Guide&#8221; and &#8220;Learn how to effectively
      use the AWS Academy Learner Lab&#8221; links, which cover some of the content of this practical.
      </p><!--l. 115--><p class="noindent" ><img 
src="images/modules-page.png" alt="PIC"  
width="498" height="499"  />
                                                                                                    
                                                                                                    
      </p></li>
<li 
  class="enumerate" id="x1-5006x3">
      <!--l. 117--><p class="noindent" >You should now see the Learner Lab interface. </p>
           <ul class="itemize1">
           <li class="itemize">
           <!--l. 119--><p class="noindent" >The AWS text, near the top left of the window, with the (currently) red circle is the link to open
           the AWS console.
           </p></li>
           <li class="itemize">
           <!--l. 120--><p class="noindent" >You can also see your budget. Note that the budget is not updated in real-time, so avoid creating
           multiple resources at once.
           </p></li>
           <li class="itemize">
           <!--l. 121--><p class="noindent" >The <span 
class="ectt-1200">00:00 </span>is a countdown of hours remaining for your lab. A lab can only remain active for 4
           hours, after which it will close, unless you press start lab again before the 4 hours expires. Once
           the lab is started, <span 
class="ectt-1200">00:00 </span>will change to <span 
class="ectt-1200">04:00</span>.
           </p></li>
           <li class="itemize">
           <!--l. 124--><p class="noindent" >AWS details will become important later but are not needed now.
           </p></li>
           <li class="itemize">
           <!--l. 125--><p class="noindent" >The README button will re-open the text panel currently on the right of the terminal interface.
           </p></li>
           <li class="itemize">
           <!--l. 126--><p class="noindent" >The README text has a lot of important information including what AWS services are available
           in the learner labs environment, please read it.
           </p></li>
           <li class="itemize">
           <!--l. 127--><p class="noindent" >The  terminal  interface  is  an  environment  with  the  SSH  keys  required  to  connect  to  AWS
           instances semi-automatically (we will use this today).</p></li></ul>
      <!--l. 130--><p class="noindent" ><img 
src="images/lab-interface.png" alt="PIC"  
width="551" height="551"  />
</p>
      <div class="tcolorbox tcolorbox" id="tcolobox-3">     
<div class="tcolorbox-title">
      <!--l. 135--><p class="noindent" >Notice</p></div> 
<div class="tcolorbox-content"><!--l. 135--><p class="noindent" >If you get an error message saying &#8220;labs.vocareum.com refused to connect.&#8221;, ensure that your
browser  is  not  in  the  incognito  mode.  If  you  still  encounter  this  error,  try  using  a  different
browser. </p> 
</div> 
</div>
      </li>
<li 
  class="enumerate" id="x1-5008x4">
      <!--l. 137--><p class="noindent" >Go ahead and start the lab. It will take a few moments to get ready. The red circle will turn yellow as the lab is
      starting, and green once it has started. Click on the AWS text with the green circle when it is available. This
      will open the AWS Console in a new browser tab. (You may need to enable pop-ups from
      awsacademy.) If you end up working for a company which uses AWS, welcome to your new
      home.
                                                                                                    
                                                                                                    
      </p><!--l. 146--><p class="noindent" ><img 
src="images/aws-console.png" alt="PIC"  
width="525" height="525"  />
</p>
      </li></ol>
   <div class="tcolorbox tcolorbox" id="tcolobox-4">     
<div class="tcolorbox-title">
<!--l. 158--><p class="indent" >   Aside</p></div> 
<div class="tcolorbox-content"><!--l. 158--><p class="noindent" >Amazon  Web  Services  (AWS)  is  an  Infrastructure  as  a  Service  (IaaS)  and  Software  as  a  Service
(SaaS) provider. They offer a collection of services which are helpful for development. For example,
they offer virtual compute resources, database storage options, and networking to tie it all together.
Services are offered on a pay as you go model, meaning you only pay for the seconds you use a
service. We will now get acquainted with some simple services offered by AWS. </p> 
</div> 
</div>
   
   <h3 class="sectionHead"><span class="titlemark">5    </span> <a 
 id="x1-60005"></a>AWS EC2</h3>
<!--l. 163--><p class="noindent" >Today we are focussing on using AWS&#8217;s EC2 service. Elastic Compute Cloud (EC2) is the primary compute service
offered by AWS. It allows you to create virtual machines on Amazon&#8217;s infrastructure. You have full control over this
machine and can configure it for whatever purpose you need.
</p><!--l. 168--><p class="indent" >   Navigate to the search bar in the top left and find the EC2 service. You might find this interface overwhelming.
It is important to note that since EC2 is one of the primary services offered by AWS, many smaller services we do
not need are bundled into this service.
</p>
<div class="center" 
>
<!--l. 178--><p class="noindent" >
</p><!--l. 179--><p class="noindent" ><img 
src="images/search-ec2.png" alt="PIC"  
width="498" height="360"  /></p></div>
<!--l. 183--><p class="noindent" >Today, we only need the <span 
class="ectt-1200">Instances </span>dashboard. Navigate to there and select &#8220;Launch instance&#8221;.
</p>
<div class="center" 
>
<!--l. 188--><p class="noindent" >
</p><!--l. 189--><p class="noindent" ><img 
src="images/ec2-interface.png" alt="PIC"  
width="498" height="-332"  /></p></div>
   
   <h4 class="subsectionHead"><span class="titlemark">5.1    </span> <a 
 id="x1-70005.1"></a>EC2 AMI</h4>
<!--l. 194--><p class="noindent" >First we will need to select an Amazon Machine Image (AMI). An AMI is the template that provides instructions on
how an instance should be provisioned. Amazon offers a range of built-in AMIs. There are also community AMIs
or you can create your own. As we just want a simple server today, we will use one of the built-in
AMIs.
</p><!--l. 199--><p class="indent" >   We will use the Amazon Linux 2023 AMI today, it is considered one of the fundamental images.
Every AMI has a unique AMI code, which is <span 
class="ectt-1200">ami-08b5b3a93ed654d19 </span>for the Amazon Linux 2023
AMI.
</p><!--l. 206--><p class="noindent" ><img 
src="images/launch-instance.png" alt="PIC"  
width="525" height="525"  />
   
                                                                                                    
                                                                                                    
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2    </span> <a 
 id="x1-80005.2"></a>Instance Settings</h4>
<!--l. 212--><p class="noindent" >The settings to configure your instance are:
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-8002x1">
      <!--l. 214--><p class="noindent" >Add a &#8216;Name&#8217; tag. Call it the name of your website, e.g. <span 
class="ectt-1200">hextris</span>.
      </p></li>
<li 
  class="enumerate" id="x1-8004x2">
      <!--l. 215--><p class="noindent" >Select an appropriate AMI, i.e. Amazon Linux 2023 AMI, <span 
class="ectt-1200">ami-053a45fff0a704a47</span>.
      </p></li>
<li 
  class="enumerate" id="x1-8006x3">
      <!--l. 216--><p class="noindent" >Select a 64-bit (x86) architecture.
      </p></li>
<li 
  class="enumerate" id="x1-8008x4">
      <!--l. 217--><p class="noindent" >The  instance  type  defines  the  computing,  memory,  networking  and  storage  capabilities  of  your
      instance. We do not need a large server, choose <span 
class="ectt-1200">t2.micro</span>.
      </p></li>
<li 
  class="enumerate" id="x1-8010x5">
      <!--l. 218--><p class="noindent" >Select the existing <span 
class="ectt-1200">vockey </span>(Type: RSA) key pair option.
      </p></li>
<li 
  class="enumerate" id="x1-8012x6">
      <!--l. 219--><p class="noindent" >In network settings, choose &#8216;Create security group&#8217; and select to allow SSH traffic from anywhere,
      and HTTPS and HTTP access from the internet.
      </p></li>
<li 
  class="enumerate" id="x1-8014x7">
      <!--l. 220--><p class="noindent" >Keep the &#8216;Configure storage&#8217; settings as default.
      </p></li>
<li 
  class="enumerate" id="x1-8016x8">
      <!--l. 221--><p class="noindent" >Do not worry about the &#8216;Advanced details&#8217; options for now.
      </p></li>
<li 
  class="enumerate" id="x1-8018x9">
      <!--l. 222--><p class="noindent" >You can now launch the instance to start your server.  </p></li></ol>
   
                                                                                                    
                                                                                                    
   <h3 class="sectionHead"><span class="titlemark">6    </span> <a 
 id="x1-90006"></a>Accessing the Instance</h3>
<!--l. 229--><p class="noindent" >Return to the <span 
class="ectt-1200">Instances </span>dashboard. You should see that a new instance has been created. Its instance state might
not yet be <span 
class="ectt-1200">Running</span>, if not, wait.
</p><!--l. 234--><p class="noindent" ><img 
src="images/instance-interface.png" alt="PIC"  
width="525" height="525"  />
</p><!--l. 238--><p class="noindent" >Note the public IPv4 address, as we will need to use this to connect to the server. You will also need this address to
test that installation of Hextris in section <a 
href="#x1-100007">7<!--tex4ht:ref: sec:installHextris --></a> worked.
</p><!--l. 242--><p class="indent" >
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-9002x1">
      <!--l. 243--><p class="noindent" >Return to the AWS Learner Lab interface.
      </p></li>
<li 
  class="enumerate" id="x1-9004x2">
      <!--l. 244--><p class="noindent" >Run the following, <span id="textcolor1">replacing <span 
class="ectt-1200">127.0.0.1</span></span> with the public IP address of your instance. This command
      uses the <span 
class="ectt-1200">vockey | RSA </span>key pair to gain SSH access to the machine.</p></li></ol>
<div class="framedenv" id="shaded*-1">
   <!--l. 247-->
<pre class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-9005r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ssh</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">i</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">~/.</span></span><span style="color:#000000"><span 
class="ectt-1200">ssh</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">labsuser</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">pem</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ec2</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">user@127</span></span><span style="color:#000000"><span 
class="ectt-1200">.0.0.1</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 249--><p class="noindent" >For example: &#x00A0;       <img 
src="images/access-instance.png" alt="PIC"  
 />
</p><!--l. 285--><p class="noindent" >You can also access the instance by selecting it from the list of instances in the dashboard and clicking the
"Connect" button. This will open a new tab in your browser with terminal access to your instance.
   
</p>
   <h3 class="sectionHead"><span class="titlemark">7    </span> <a 
 id="x1-100007"></a>Installing Hextris</h3>
<!--l. 291--><p class="noindent" >Hextris <span class="cite">[<a 
href="#Xhextris">1</a>]</span> is very simple to install. Using an EC2 interface is perhaps overkill for it. It is an entirely client-side/static
web application, which means we just have to serve the static files.
</p><!--l. 294--><p class="indent" >   First, we will need to enable serving of static files. We can install and start the <span 
class="ectt-1200">httpd </span>service to do this. The AMI
we have picked uses the <span 
class="ectt-1200">yum </span>package manager, so to install <span 
class="ectt-1200">httpd </span>we run:
</p>
   <div class="framedenv" id="code-1">
<!--l. 298--><pre class="listings" id="listing-2"><span class="label"><a 
 id="x1-10001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sudo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">yum</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">install</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span> 
<span class="label"><a 
 id="x1-10002r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">Last</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">metadata</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">expiration</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">check</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-10003r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">Dependencies</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">resolved</span></span> 
<span class="label"><a 
 id="x1-10004r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">.....</span></span> 
<span class="label"><a 
 id="x1-10005r5"></a></span><span style="color:#000000"><span 
class="ectt-1200">.....</span></span> 
<span class="label"><a 
 id="x1-10006r6"></a></span><span style="color:#000000"><span 
class="ectt-1200">Total</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">download</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">size</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">2.3</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">M</span></span> 
<span class="label"><a 
 id="x1-10007r7"></a></span><span style="color:#000000"><span 
class="ectt-1200">Installed</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">size</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">6.9</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">M</span></span> 
<span class="label"><a 
 id="x1-10008r8"></a></span><span style="color:#000000"><span 
class="ectt-1200">Is</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">this</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ok</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">y</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">N</span></span><span style="color:#000000"><span 
class="ectt-1200">]:</span></span> 
<span class="label"><a 
 id="x1-10009r9"></a></span> 
<span class="label"><a 
 id="x1-10010r10"></a></span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">enter</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">y</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">to</span></span><span style="color:#33997E"> </span><span style="color:#33997E"><span 
class="ectt-1200">install</span></span> 
<span class="label"><a 
 id="x1-10011r11"></a></span><span style="color:#000000"><span 
class="ectt-1200">.....</span></span> 
<span class="label"><a 
 id="x1-10012r12"></a></span><span style="color:#000000"><span 
class="ectt-1200">.....</span></span> 
<span class="label"><a 
 id="x1-10013r13"></a></span><span style="color:#000000"><span 
class="ectt-1200">Complete</span></span><span style="color:#000000"><span 
class="ectt-1200">!</span></span> 
<span class="label"><a 
 id="x1-10014r14"></a></span><span style="color:#000000"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sudo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">systemctl</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">enable</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span> 
<span class="label"><a 
 id="x1-10015r15"></a></span><span style="color:#000000"><span 
class="ectt-1200">Created</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">symlink</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">from</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">etc</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">systemd</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">system</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">multi</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">user</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">target</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">wants</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">service</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">usr</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">lib</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">systemd</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">system</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">service</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span> 
<span class="label"><a 
 id="x1-10016r16"></a></span><span style="color:#000000"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sudo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">systemctl</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">start</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span>
 
<span class="label"><a 
 id="x1-10017r17"></a></span></pre>
   </div>
<!--l. 317--><p class="indent" >   All files in the <span 
class="ectt-1200">/var/www/html </span>directory will now be served when accessed via <span 
class="Cabin-Bold-tlf-t1-x-x-120">HTTP</span>. Navigate
to the public IP address of your EC2 instance in the browser. You should see an &#8220;It works!&#8221; landing
page.
                                                                                                    
                                                                                                    
</p><!--l. 321--><p class="indent" >   Change to the <span 
class="ectt-1200">/var/www/html </span>directory and notice that it is currently empty. We need to download the static
files to this directory so that they can be served. We can use git for this (though it is not the most suited tool), but
first git needs to be installed on the instance.
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 326-->
<pre class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-10018r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sudo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">yum</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">install</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">git</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 328--><p class="indent" >   Finally, confirm that we are in the <span 
class="ectt-1200">/var/www/html </span>directory.
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 330-->
<pre class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-10019r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">cd</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">var</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">www</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">html</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 334--><p class="indent" >   And clone the repository into that directory.
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 336-->
<pre class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-10020r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">sudo</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">git</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">clone</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">https</span></span><span style="color:#000000"><span 
class="ectt-1200">://</span></span><span style="color:#000000"><span 
class="ectt-1200">github</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">com</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">Hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 341--><p class="indent" >   Now if you navigate to the <span 
class="Cabin-Bold-tlf-t1-x-x-120">http </span>address of the public IP address (e.g. <a 
href="http://18.208.165.253" class="url" ><span 
class="ectt-1200">http://18.208.165.253</span></a>), you should
be able to see your newly deployed website. Congratulations!
</p>
   <div class="tcolorbox tcolorbox" id="tcolobox-5">     
<div class="tcolorbox-title">
<!--l. 345--><p class="indent" >   Notice</p></div> 
<div class="tcolorbox-content"><!--l. 345--><p class="noindent" >If you are having timeout issues, one problem could be using <span 
class="ectt-1200">https </span>to connect rather than <span 
class="ectt-1200">http</span>. </p> 
</div> 
</div>
   
   <h3 class="sectionHead"><span class="titlemark">8    </span> <a 
 id="x1-110008"></a>Switching to Terraform</h3>
<!--l. 352--><p class="noindent" >For the remainder of the practical we will use Terraform to provision the same instance we just created.
</p><!--l. 354--><p class="indent" >
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-11002x1">
      <!--l. 355--><p class="noindent" >First, please delete any running instances in your AWS account using the AWS Console.
      </p></li>
<li 
  class="enumerate" id="x1-11004x2">
      <!--l. 356--><p class="noindent" >Next, navigate to the GitHub Classroom link for this practical provided at the start of this document.
      This will create a new repository where we can work on Terraform.</p></li></ol>
   
                                                                                                    
                                                                                                    
   <h3 class="sectionHead"><span class="titlemark">9    </span> <a 
 id="x1-120009"></a>Using Terraform in AWS Learner Labs</h3>
<!--l. 362--><p class="noindent" >We will redeploy our Hextris application using Infrastructure as Code (IaC) to do so. You will need to keep your lab
running for the next steps. (Now is a good time to click start to refresh your 4 hours.)
</p><!--l. 366--><p class="indent" >
      </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-12002x1">
      <!--l. 367--><p class="noindent" >Click on &#8216;AWS Details&#8217; to display information about the lab.
      </p><!--l. 369--><p class="noindent" ><img 
src="images/aws-details.png" alt="PIC"  
width="525" height="525"  />
      </p></li>
<li 
  class="enumerate" id="x1-12004x2">
      <!--l. 372--><p class="noindent" >Click  on  the  first  &#8216;Show&#8217;  button  next  to  &#8216;AWS  CLI&#8217;  which  will  display  a  text  block  starting  with
      <span 
class="ectt-1200">[default]</span>.
      </p></li>
<li 
  class="enumerate" id="x1-12006x3">
      <!--l. 373--><p class="noindent" >Within your repository create a <span 
class="ectt-1200">credentials </span>file and copy the contents of the text block into the
      file. <span 
class="Cabin-Bold-tlf-t1-x-x-120">Do not share this file contents &#8212; do not commit it</span>. This file is added to the <span 
class="ectt-1200">.gitignore </span>of your
      repository by default.
      </p></li>
<li 
  class="enumerate" id="x1-12008x4">
      <!--l. 376--><p class="noindent" >Create a <span 
class="ectt-1200">main.tf </span>file in the same directory with the following contents:    </p><div class="framedenv" id="code-1">
      <!--l. 377--><p class="noindent" ><span 
class="ectt-1200">» cat main.tf</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 377--><pre class="listings" id="listing-6"><span class="label"><a 
 id="x1-12009r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12010r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#006699"><span 
class="ectt-1200">required_providers</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12011r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">aws</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12012r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">source</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hashicorp</span></span><span style="color:#669900"><span 
class="ectt-1200">/</span></span><span style="color:#669900"><span 
class="ectt-1200">aws</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-12013r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">version</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">~&#x003E;</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">5.0</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-12014r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-12015r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-12016r8"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-12017r9"></a></span> 
<span class="label"><a 
 id="x1-12018r10"></a></span><span style="color:#006699"><span 
class="ectt-1200">provider</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12019r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">region</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">us</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">east</span></span><span style="color:#669900"><span 
class="ectt-1200">-1</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-12020r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">shared_credentials_files</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">./</span></span><span style="color:#669900"><span 
class="ectt-1200">credentials</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-12021r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">default_tags</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12022r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">tags</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-12023r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Environment</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Dev</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-12024r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Course</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">CSSE6400</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-12025r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">StudentID</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">&#x003C;</span></span><span style="color:#669900"><span 
class="ectt-1200">Your</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">Student</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">ID</span></span><span style="color:#669900"><span 
class="ectt-1200">&#x003E;</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-12026r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-12027r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-12028r20"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
       
<span class="label"><a 
 id="x1-12029r21"></a></span></pre>
      </div>
      <!--l. 400--><p class="noindent" >The <span 
class="ectt-1200">terraform </span>block specifies the required external dependencies, here we need to use the AWS provider
      above version 5.0. The <span 
class="ectt-1200">provider </span>block configures the AWS provider, instructing it which region to use and
      how to authenticate (using the credentials file we created). We also include some <span 
class="ectt-1200">tags </span>to add
      to any resource made by this provider, these are useful for keeping track of resources in the
      console.
      </p></li>
<li 
  class="enumerate" id="x1-12031x5">
      <!--l. 404--><p class="noindent" >We need to initialise Terraform, which will download the required dependencies. This is done with the
      <span 
class="ectt-1200">terraform init </span>command.  </p><div class="framedenv" id="shaded*-1">
      <!--l. 406-->
      <pre class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-12032r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">init</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
      
      </div>
      <!--l. 408--><p class="noindent" >This command will create a <span 
class="ectt-1200">.terraform </span>directory which stores providers and a provider lock file,
      <span 
class="ectt-1200">.terraform.lock.hcl</span>.
                                                                                                    
                                                                                                    
      </p></li>
<li 
  class="enumerate" id="x1-12034x6">
      <!--l. 410--><p class="noindent" >To verify that we have setup Terraform correctly, use <span 
class="ectt-1200">terraform plan</span>.  </p><div class="framedenv" id="shaded*-1">
      <!--l. 411-->
      <pre class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-12035r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">plan</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
      
      </div>
      <!--l. 413--><p class="noindent" >As we currently have no resources configured, it should find that no changes are required. Note that this
      does not ensure our credentials are correctly configured, as Terraform has no reason to try authenticating
      yet.
</p>
      </li></ol>
   
   <h3 class="sectionHead"><span class="titlemark">10    </span> <a 
 id="x1-1300010"></a>Deploying Hextris</h3>
<!--l. 420--><p class="noindent" >First, we will need to create an EC2 instance resource. The AWS provider calls this resource an
<a 
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance" ><span 
class="ectt-1200">aws_instance</span></a><span class="footnote-mark"><a 
href="#fn2x0" id="fn2x0-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-13001f2"></a>.
Get familiar with the documentation page. Most Terraform providers have reasonable documentation. Reading
the argument reference section helps to understand what a resource is capable of doing.
</p><!--l. 426--><p class="indent" >   We will start off with the basic information for the resource. Configure it to use a specific Amazon Machine
Instance (AMI), and chose the <span 
class="ectt-1200">t2.micro </span>size. We will also give it a name so that it is easy to find. Add the following
basic <span 
class="ectt-1200">resource </span>block to <span 
class="ectt-1200">main.tf</span>:
</p><!--l. 431--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 431--><p class="indent" >   <span 
class="ectt-1200">» cat main.tf</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 431--><pre class="listings" id="listing-9"><span class="label"><a 
 id="x1-13003r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">resource</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">server</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13004r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">ami</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">ami</span></span><span style="color:#669900"><span 
class="ectt-1200">-08</span></span><span style="color:#669900"><span 
class="ectt-1200">b5b3a93ed654d19</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13005r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">instance_type</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">t2</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">micro</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13006r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">key_name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">vockey</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13007r5"></a></span> 
<span class="label"><a 
 id="x1-13008r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">tags</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13009r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13010r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-13011r9"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-13012r10"></a></span></pre>
   </div>
<!--l. 443--><p class="indent" >   To create the server, invoke <span 
class="ectt-1200">terraform apply</span>, which will first do <span 
class="ectt-1200">terraform plan </span>and prompt us to confirm if
we want to apply the changes.
</p>
   <div class="framedenv" id="shaded*-1">
   <!--l. 446-->
<pre class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-13013r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">apply</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 448--><p class="indent" >   You should be prompted with something similar to the output below.
</p>
   <div class="framedenv" id="code-1">
<!--l. 450--><pre class="listings" id="listing-11"><span class="label"><a 
 id="x1-13014r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">Terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">used</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">the</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">selected</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">providers</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">generate</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">the</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">following</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">execution</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">plan</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Resource</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">actions</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">are</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">indicated</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">with</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">the</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">following</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">symbols</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-13015r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">create</span></span> 
<span class="label"><a 
 id="x1-13016r3"></a></span> 
<span class="label"><a 
 id="x1-13017r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">Terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">will</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">perform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">the</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">following</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">actions</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-13018r5"></a></span> 
<span class="label"><a 
 id="x1-13019r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">#</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">will</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">be</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">created</span></span> 
<span class="label"><a 
 id="x1-13020r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">resource</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13021r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">ami</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">ami</span></span><span style="color:#000000"><span 
class="ectt-1200">-08</span></span><span style="color:#000000"><span 
class="ectt-1200">b5b3a93ed654d19</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13022r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">omitted</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13023r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">instance_type</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">t2</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">micro</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13024r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">omitted</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13025r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">tags</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13026r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">+</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">Name</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-13027r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-13028r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#000000"><span 
class="ectt-1200">omitted</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-13029r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-13030r17"></a></span> 
<span class="label"><a 
 id="x1-13031r18"></a></span><span style="color:#000000"><span 
class="ectt-1200">Plan</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">add</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">change</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">destroy</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span> 
<span class="label"><a 
 id="x1-13032r19"></a></span> 
<span class="label"><a 
 id="x1-13033r20"></a></span><span style="color:#000000"><span 
class="ectt-1200">Do</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">you</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">want</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">perform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">these</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">actions</span></span><span style="color:#000000"><span 
class="ectt-1200">?</span></span> 
<span class="label"><a 
 id="x1-13034r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">will</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">perform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">the</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">actions</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">described</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">above</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span> 
<span class="label"><a 
 id="x1-13035r22"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Only</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"><span 
class="ectt-1200">yes</span></span><span style="color:#000000"><span 
class="tctt-1200">'</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">will</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">be</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">accepted</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">to</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">approve</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span> 
<span class="label"><a 
 id="x1-13036r23"></a></span> 
<span class="label"><a 
 id="x1-13037r24"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Enter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">value</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span>
 
<span class="label"><a 
 id="x1-13038r25"></a></span></pre>
   </div>
<!--l. 477--><p class="indent" >   If the plan looks sensible enter <span 
class="ectt-1200">yes </span>to enact the changes.
</p>
   <div class="framedenv" id="code-1">
                                                                                                    
                                                                                                    
<!--l. 479--><pre class="listings" id="listing-12"><span class="label"><a 
 id="x1-13039r1"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Enter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">a</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">value</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">yes</span></span> 
<span class="label"><a 
 id="x1-13040r2"></a></span> 
<span class="label"><a 
 id="x1-13041r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Creating</span></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span> 
<span class="label"><a 
 id="x1-13042r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Still</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">creating</span></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[10</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">elapsed</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-13043r5"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Still</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">creating</span></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[20</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">elapsed</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-13044r6"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Still</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">creating</span></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[30</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">elapsed</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-13045r7"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Still</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">creating</span></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[40</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">elapsed</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-13046r8"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Creation</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">complete</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">after</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">47</span></span><span style="color:#000000"><span 
class="ectt-1200">s</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">i</span></span><span style="color:#000000"><span 
class="ectt-1200">-08</span></span><span style="color:#000000"><span 
class="ectt-1200">c92a097ae7c5b18</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-13047r9"></a></span> 
<span class="label"><a 
 id="x1-13048r10"></a></span><span style="color:#000000"><span 
class="ectt-1200">Apply</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">complete</span></span><span style="color:#000000"><span 
class="ectt-1200">!</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Resources</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">1</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">added</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">changed</span></span><span style="color:#000000"><span 
class="ectt-1200">,</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">destroyed</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span>
 
<span class="label"><a 
 id="x1-13049r11"></a></span></pre>
   </div>
<!--l. 492--><p class="indent" >   You can now check in the AWS Console that another EC2 instance with the name <span 
class="ectt-1200">hextris </span>has been
created. Now that we have a server, we should try to configure it to serve Hextris. We will use the
<span 
class="ectt-1200">user_data </span>field, which configures commands to run when launching the instance. First we need a
script to provision the server, if we combine all our commands from section <a 
href="#x1-100007">7<!--tex4ht:ref: sec:installHextris --></a>, we will produce this
script:
</p><!--l. 497--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 497--><p class="indent" >   <span 
class="ectt-1200">» cat serve-hextris.sh</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 497--><pre class="listings" id="listing-13"><span class="label"><a 
 id="x1-13050r1"></a></span><span style="color:#33997E"><span 
class="ectt-1200">#</span></span><span style="color:#33997E"><span 
class="ectt-1200">!/</span></span><span style="color:#33997E"><span 
class="ectt-1200">bin</span></span><span style="color:#33997E"><span 
class="ectt-1200">/</span></span><span style="color:#33997E"><span 
class="ectt-1200">bash</span></span> 
<span class="label"><a 
 id="x1-13051r2"></a></span><span style="color:#000000"><span 
class="ectt-1200">yum</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">install</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">y</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span> 
<span class="label"><a 
 id="x1-13052r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">systemctl</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">enable</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span> 
<span class="label"><a 
 id="x1-13053r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">systemctl</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">start</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">httpd</span></span> 
<span class="label"><a 
 id="x1-13054r5"></a></span> 
<span class="label"><a 
 id="x1-13055r6"></a></span><span style="color:#000000"><span 
class="ectt-1200">yum</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">install</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">y</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">git</span></span> 
<span class="label"><a 
 id="x1-13056r7"></a></span><span style="color:#006699"><span 
class="ectt-1200">cd</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">var</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">www</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">html</span></span> 
<span class="label"><a 
 id="x1-13057r8"></a></span><span style="color:#000000"><span 
class="ectt-1200">git</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">clone</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">https</span></span><span style="color:#000000"><span 
class="ectt-1200">://</span></span><span style="color:#000000"><span 
class="ectt-1200">github</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">com</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">Hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">.</span></span>
 
<span class="label"><a 
 id="x1-13058r9"></a></span></pre>
   </div>
<!--l. 512--><p class="indent" >   Now we can add the following field to our Terraform resource. It uses the Terraform <span 
class="ectt-1200">file </span>function to load the
contents of a file named <span 
class="ectt-1200">serve-hextris.sh</span>, relative to the Terraform directory. The contents of that file is passed
to the <span 
class="ectt-1200">user_data </span>field.
</p>
   <div class="framedenv" id="code-1">
<!--l. 517--><pre class="listings" id="listing-14"><span class="label"><a 
 id="x1-13059r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">user_data</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">file</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">./</span></span><span style="color:#669900"><span 
class="ectt-1200">serve</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">sh</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span>
 
<span class="label"><a 
 id="x1-13060r2"></a></span></pre>
   </div>
<!--l. 521--><p class="indent" >   If you run the <span 
class="ectt-1200">terraform plan </span>command now, you will notice that Terraform has identified that this change
will require creating a new EC2 instance. Where possible, Terraform will try to update a resource in-place
but since this changes how an instance is started, it needs to be replaced. Go ahead and apply the
changes.
</p><!--l. 527--><p class="indent" >   Now, in theory, we should have deployed Hextris to an EC2 instance. But how do we access that instance? We
<span 
class="Cabin-Italic-tlf-t1-x-x-120">could </span>go to the AWS Console and find the public IP address. However, it turns out that Terraform already knows
the public IP address. In fact, if you open the Terraform state file (<span 
class="ectt-1200">terraform.tfstate</span>), you should be able to find
it hidden away in there. But, we do not want to go hunting through this file all the time. Instead we will use the
<span 
class="ectt-1200">output </span>keyword.
</p><!--l. 536--><p class="indent" >   We can specify certain attributes as &#8216;output&#8217; attributes. Output attributes are printed to the terminal when the
module is invoked directly but as we will see later, they can also be used by other Terraform configuration
files.
</p><!--l. 540--><p class="indent" >   </p><div class="framedenv" id="code-1">
<!--l. 540--><p class="indent" >   <span 
class="ectt-1200">» cat main.tf</span> </p></div>   <div class="framedenv" id="code-1"><!--l. 540--><pre class="listings" id="listing-15"><span class="label"><a 
 id="x1-13061r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">output</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">url</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-13062r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">value</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">public_ip</span></span> 
<span class="label"><a 
 id="x1-13063r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-13064r4"></a></span></pre>
   </div>
<!--l. 546--><p class="indent" >   This creates a new output attribute, <span 
class="ectt-1200">hextris-url</span>, which references the <span 
class="ectt-1200">public_ip </span>attribute of our
<span 
class="ectt-1200">hextris-server </span>resource. Note that resources in Terraform are addressed by the resource type (<span 
class="ectt-1200">aws_instance</span>)
followed by the name of the resource (<span 
class="ectt-1200">hextris-server</span>).
</p><!--l. 551--><p class="indent" >   If you <span 
class="ectt-1200">apply </span>the changes, it should tell you the public IP address of the instance resource.  </p><div class="framedenv" id="shaded*-1">
   <!--l. 552-->
<pre class="lstlisting" id="listing-16"><span class="label"><a 
 id="x1-13065r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">apply</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
   <div class="framedenv" id="code-1">
<!--l. 554--><pre class="listings" id="listing-17"><span class="label"><a 
 id="x1-13066r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">Refreshing</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">state</span></span><span style="color:#000000"><span 
class="ectt-1200">...</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"><span 
class="ectt-1200">i</span></span><span style="color:#000000"><span 
class="ectt-1200">-043</span></span><span style="color:#000000"><span 
class="ectt-1200">a61ff86aa272e0</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-13067r2"></a></span> 
<span class="label"><a 
 id="x1-13068r3"></a></span><span style="color:#000000"><span 
class="ectt-1200">Outputs</span></span><span style="color:#000000"><span 
class="ectt-1200">:</span></span> 
<span class="label"><a 
 id="x1-13069r4"></a></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">url</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">"3.82.225.65"</span></span>
 
<span class="label"><a 
 id="x1-13070r5"></a></span></pre>
                                                                                                    
                                                                                                    
   </div>
<!--l. 561--><p class="indent" >   You can apply this plan to save these new output values to the Terraform state, without changing any real
infrastructure.
</p><!--l. 563--><p class="indent" >   So let&#8217;s try and access that URL, hmm. That is strange. Something has gone wrong.
   
</p>
   <h3 class="sectionHead"><span class="titlemark">11    </span> <a 
 id="x1-1400011"></a>Security Groups</h3>
<!--l. 568--><p class="noindent" >When we setup our EC2 instance using the AWS Console, it helpfully created a new security group for us. We
specified that this security group should allow SSH, HTTP, and HTTPS traffic by allowing traffic from ports 22, 80,
and 443 respectively. When configuring with Terraform, security groups and their attachment to EC2 instances are
separate resources. Refer back to the Terraform documentation for details or, as is normally quicker,  <a 
href="https://www.google.com/search?q=terraform+aws+security+group" >Google
&#8220;terraform aws security group&#8221;</a>.
</p><!--l. 575--><p class="indent" >   First, let us create an appropriate security group. Recall that in the AWS Console configuration, ingress SSH access (port
22) and all egress<span class="footnote-mark"><a 
href="#fn3x0" id="fn3x0-bk"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-14001f3"></a>
traffic were automatically configured and we just added ingress port 80. In Terraform the whole state must be
configured so we specify two <span 
class="ectt-1200">ingress </span>blocks, one for HTTP (port 80) and one for SSH access (port
22).<span class="footnote-mark"><a 
href="#fn4x0" id="fn4x0-bk"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-14003f4"></a>
Additionally, we will create egress for all outgoing traffic.
</p>
   <div class="framedenv" id="code-1">
<!--l. 586--><pre class="listings" id="listing-18"><span class="label"><a 
 id="x1-14005r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">resource</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws_security_group</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">server</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-14006r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">server</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14007r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">description</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">Hextris</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">HTTP</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">and</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">SSH</span></span><span style="color:#669900"> </span><span style="color:#669900"><span 
class="ectt-1200">access</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14008r4"></a></span> 
<span class="label"><a 
 id="x1-14009r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">ingress</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-14010r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">from_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">80</span></span> 
<span class="label"><a 
 id="x1-14011r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">to_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">80</span></span> 
<span class="label"><a 
 id="x1-14012r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">protocol</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">tcp</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14013r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">cidr_blocks</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">0.0.0.0/0</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-14014r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-14015r11"></a></span> 
<span class="label"><a 
 id="x1-14016r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">ingress</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-14017r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">from_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">22</span></span> 
<span class="label"><a 
 id="x1-14018r14"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">to_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">22</span></span> 
<span class="label"><a 
 id="x1-14019r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">protocol</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">tcp</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14020r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">cidr_blocks</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">0.0.0.0/0</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-14021r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-14022r18"></a></span> 
<span class="label"><a 
 id="x1-14023r19"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">egress</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-14024r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">from_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span> 
<span class="label"><a 
 id="x1-14025r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">to_port</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">0</span></span> 
<span class="label"><a 
 id="x1-14026r22"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">protocol</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">-1</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-14027r23"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">cidr_blocks</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">0.0.0.0/0</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-14028r24"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-14029r25"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-14030r26"></a></span></pre>
   </div>
<!--l. 614--><p class="indent" >   Note the following: </p>
      <ul class="itemize1">
      <li class="itemize">
      <!--l. 616--><p class="noindent" ><span 
class="ectt-1200">from_port </span>and <span 
class="ectt-1200">to_port </span>are the start and end of a range of ports rather than incoming or outgoing.
      In this example our range is 80-80.
      </p></li>
      <li class="itemize">
      <!--l. 617--><p class="noindent" ><span 
class="ectt-1200">protocol </span>set to &#8220;-1&#8221; is a special flag to indicate all protocols.
      </p></li>
      <li class="itemize">
      <!--l. 618--><p class="noindent" >Explaining <span 
class="ectt-1200">cidr </span>is outside the scope of the course, but the specified block above means to apply to
      all IP addresses.</p></li></ul>
<!--l. 621--><p class="indent" >   You may now <span 
class="ectt-1200">apply </span>the changes to create this new security group resource.
</p><!--l. 623--><p class="indent" >   Next, we will attach the security group to the EC2 instance. Return to the <span 
class="ectt-1200">aws_instance.hextrix-server</span>
resource and include the following line:
</p>
   <div class="framedenv" id="code-1">
<!--l. 627--><pre class="listings" id="listing-19"><span class="label"><a 
 id="x1-14031r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">security_groups</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">aws_security_group</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span>
 
<span class="label"><a 
 id="x1-14032r2"></a></span></pre>
                                                                                                    
                                                                                                    
   </div>
<!--l. 631--><p class="indent" >   Note that EC2 instances can have multiple security groups. Once again notice the structure of resource
identifiers in AWS.
</p><!--l. 638--><p class="indent" >   Now <span 
class="ectt-1200">apply </span>the changes. If you now try to access via the IP address (the IP address may have changed), you
should be able to view the Hextris website.
   
</p>
   <h3 class="sectionHead"><span class="titlemark">12    </span> <a 
 id="x1-1500012"></a>Tearing Down</h3>
<!--l. 646--><p class="noindent" >One of the important features of Infrastructure as Code (IaC) is all the configuration we just did is stored in a file.
This file can, and should be, version controlled and subject to the same quality rules of code files. It
also means that if we want to redeploy Hextris at any point, we can easily just run the IaC to deploy
it.
</p><!--l. 651--><p class="indent" >   To try this out, let us first take everything down. We can do this with:  </p><div class="framedenv" id="shaded*-1">
   <!--l. 653-->
<pre class="lstlisting" id="listing-20"><span class="label"><a 
 id="x1-15001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">destroy</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 655--><p class="indent" >   You should be prompted to confirm that you want to destroy all of the resources in the state. Once Terraform
has finished taking everything down, confirm that you can no longer access the website and that the AWS console
says the instances have been destroyed.
</p><!--l. 659--><p class="indent" >   Now go ahead and apply the changes to bring everything back:  </p><div class="framedenv" id="shaded*-1">
   <!--l. 660-->
<pre class="lstlisting" id="listing-21"><span class="label"><a 
 id="x1-15002r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">terraform</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">apply</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 662--><p class="indent" >   Confirm that this brings the website back exactly as before (with a different IP address). You can now start any
lab you want and almost instantly spin back up the website you have configured. That is the beauty of
Infrastructure as Code!
</p><!--l. 666--><p class="indent" >   <span 
class="Cabin-Bold-tlf-t1-x-x-120">Hint: </span>Destroy everything again before you finish.
   
</p>
   <h3 class="sectionHead"><span class="titlemark">13    </span> <a 
 id="x1-1600013"></a>Automated Testing</h3>
<!--l. 670--><p class="noindent" >A quick note about automated testing. As with all the practicals thus far, this practical has automated tests enabled
on your repository.
</p><!--l. 674--><p class="indent" >   From within your repository, you can run the tests locally with:  </p><div class="framedenv" id="shaded*-1">
   <!--l. 675-->
<pre class="lstlisting" id="listing-22"><span class="label"><a 
 id="x1-16001r1"></a></span><span style="color:#000000"><span 
class="ectt-1200">$</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">csse6400</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">bin</span></span><span style="color:#000000"><span 
class="ectt-1200">/</span></span><span style="color:#000000"><span 
class="ectt-1200">unittest</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">sh</span></span><span 
class="ectt-1200">&#x00A0;</span></pre>
   </div>
<!--l. 677--><p class="indent" >   While the emails saying that the tests failed can be annoying, these automated tests allow us to ensure that
everyone is keeping up with the practical content.
</p><!--l. 680--><p class="indent" >   If fixing the test failures is not too hard, please try to do so. If you are repeatedly not passing the practicals, we
may reach out to ensure that you are not being left behind in the content.
                                                                                                    
                                                                                                    
   
</p>
   <h3 class="sectionHead"><span class="titlemark">14    </span> <a 
 id="x1-1700014"></a>Extension</h3>
   <div class="tcolorbox tcolorbox" id="tcolobox-6">     
<div class="tcolorbox-title">
<!--l. 688--><p class="indent" >   Info</p></div> 
<div class="tcolorbox-content"><!--l. 688--><p class="noindent" >This section is for students who have completed the practical and want to extend their knowledge.
</p> 
</div> 
</div>
<!--l. 690--><p class="noindent" >Since CSSE6400 runs this practical every year, sometimes the AMI that we were using is out of date or does not
exist any more. For this practical, we could instead query AWS for the latest AMI and use that in our
Terraform.
</p><!--l. 693--><p class="indent" >   To do this we introduce a new data source, <span 
class="ectt-1200">aws_ami</span>. Data sources fetch or query data from the provider, rather
than creating something.
</p><!--l. 696--><p class="indent" >   Add the following to your <span 
class="ectt-1200">main.tf </span>file:
</p>
   <div class="framedenv" id="code-1">
<!--l. 698--><pre class="listings" id="listing-23"><span class="label"><a 
 id="x1-17001r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">data</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws_ami</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">latest</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17002r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">most_recent</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">true</span></span> 
<span class="label"><a 
 id="x1-17003r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">owners</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">amazon</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-17004r4"></a></span> 
<span class="label"><a 
 id="x1-17005r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">filter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17006r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">name</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17007r7"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">values</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">al2023</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">ami</span></span><span style="color:#669900"><span 
class="ectt-1200">-2023*</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-17008r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-17009r9"></a></span> 
<span class="label"><a 
 id="x1-17010r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">filter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17011r11"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">root</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">device</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">type</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17012r12"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">values</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">ebs</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-17013r13"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-17014r14"></a></span> 
<span class="label"><a 
 id="x1-17015r15"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">filter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17016r16"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">virtualization</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">type</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17017r17"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">values</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hvm</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-17018r18"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-17019r19"></a></span> 
<span class="label"><a 
 id="x1-17020r20"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">filter</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17021r21"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">architecture</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17022r22"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">values</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">x86_64</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-17023r23"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-17024r24"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-17025r25"></a></span></pre>
   </div>
<!--l. 725--><p class="indent" >   The <span 
class="ectt-1200">aws_ami </span>data source will find the latest Amazon Linux 2023 AMI for 64 bit x86, which is what is running
on our EC2 instance.
</p><!--l. 727--><p class="indent" >   To use the data source we need to change the <span 
class="ectt-1200">ami </span>attribute of the <span 
class="ectt-1200">aws_instance </span>resource to use the data
source. This is done as so:
</p>
   <div class="framedenv" id="code-1">
<!--l. 729--><pre class="listings" id="listing-24"><span class="label"><a 
 id="x1-17026r1"></a></span><span style="color:#006699"><span 
class="ectt-1200">resource</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">aws_instance</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">server</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17027r2"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">ami</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#006699"><span 
class="ectt-1200">data</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">aws_ami</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">latest</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">id</span></span> 
<span class="label"><a 
 id="x1-17028r3"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">instance_type</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">t2</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">micro</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17029r4"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">key_name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">vockey</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17030r5"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">security_groups</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">[</span></span><span style="color:#000000"><span 
class="ectt-1200">aws_security_group</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">hextris</span></span><span style="color:#000000"><span 
class="ectt-1200">-</span></span><span style="color:#000000"><span 
class="ectt-1200">server</span></span><span style="color:#000000"><span 
class="ectt-1200">.</span></span><span style="color:#000000"><span 
class="ectt-1200">name</span></span><span style="color:#000000"><span 
class="ectt-1200">]</span></span> 
<span class="label"><a 
 id="x1-17031r6"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">user_data</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">file</span></span><span style="color:#000000"><span 
class="ectt-1200">(</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">./</span></span><span style="color:#669900"><span 
class="ectt-1200">serve</span></span><span style="color:#669900"><span 
class="ectt-1200">-</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">.</span></span><span style="color:#669900"><span 
class="ectt-1200">sh</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#000000"><span 
class="ectt-1200">)</span></span> 
<span class="label"><a 
 id="x1-17032r7"></a></span> 
<span class="label"><a 
 id="x1-17033r8"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">tags</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">{</span></span> 
<span class="label"><a 
 id="x1-17034r9"></a></span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">Name</span></span><span style="color:#000000"> </span><span style="color:#000000"><span 
class="ectt-1200">=</span></span><span style="color:#000000"> </span><span style="color:#669900"><span 
class="ectt-1200">"</span></span><span style="color:#669900"><span 
class="ectt-1200">hextris</span></span><span style="color:#669900"><span 
class="ectt-1200">"</span></span> 
<span class="label"><a 
 id="x1-17035r10"></a></span><span 
class="ectt-1200">&#x00A0;</span><span style="color:#000000"><span 
class="ectt-1200">}</span></span> 
<span class="label"><a 
 id="x1-17036r11"></a></span><span style="color:#000000"><span 
class="ectt-1200">}</span></span>
 
<span class="label"><a 
 id="x1-17037r12"></a></span></pre>
   </div>
<!--l. 743--><p class="indent" >   And now, if we run <span 
class="ectt-1200">terraform plan</span>, we will see that it wants to destroy and recreate the EC2 instance. This is
because the AMI has changed since this practical was first updated for this year.
   
</p>
   <h3 class="likesectionHead"><a 
 id="x1-18000"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xhextris"></a>L.&#x00A0;Engstrom,            G.&#x00A0;Finucane,            N.&#x00A0;Moroze,            and            M.&#x00A0;Yang,            &#8220;Hextris.&#8221;            
<a 
href="https://github.com/hextris/hextris/" class="url" ><span 
class="ectt-1200">https://github.com/hextris/hextris/</span></a>, 2014.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xaws-regions"></a>&#8220;Aws global infrastructure.&#8221; <a 
href="https://aws.amazon.com/about-aws/global-infrastructure/" class="url" ><span 
class="ectt-1200">https://aws.amazon.com/about-aws/global-infrastructure/</span></a>,
   March 2025.
</p>
   </div>
                                                                                                    
                                                                                                    
   
   <h3 class="sectionHead"><span class="titlemark">A    </span> <a 
 id="x1-19000A"></a>AWS Networking Terminology</h3>
   
<!--l. 754--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-20000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">AWS Regions</span></span>
   Regions are the physical locations of AWS data centres. When applying Terraform, the changes are being
made to one region at a time. In our case we specified the region <span 
class="ectt-1200">us-east-1</span>. Often you do not need to
deploy to more than one region, however, it can help decrease latency and reduce risk from a major
disaster. Generally, pick a region and stick with it, we have picked <span 
class="ectt-1200">us-east-1 </span>because it is the least
expensive.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                                    
                                                                                                    
<a 
 id="x1-200011"></a>
                                                                                                    
                                                                                                    
<!--l. 764--><p class="noindent" ><img 
src="images/aws_regions.png" alt="PIC"  
width="525" height="525"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">AWS Regions as of March 2025 <span class="cite">[<a 
href="#Xaws-regions">2</a>]</span></span></div><!--tex4ht:label?: x1-200011 -->
                                                                                                    
                                                                                                    
   </div><hr class="endfigure" />
   
<!--l. 768--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-21000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">Availability Zones</span></span>
   An AWS Region will consist of availability zones, normally named with letters. For example, the
AWS Region located in Sydney, <span 
class="ectt-1200">ap-southeast-2 </span>has three availability zones: <span 
class="ectt-1200">ap-southeast-2a</span>,
<span 
class="ectt-1200">ap-southeast-2b</span>, and <span 
class="ectt-1200">ap-southeast-2c</span>. An availability zone is a collection of resources which run on
separate power supplies and networks. Reducing the risk that multiple availability zones would fail at
once.
   
</p>
<!--l. 775--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-22000"></a><span 
class="Cabin-Bold-tlf-t1-x-x-120">VPC</span></span>
   Virtual Private Clouds, or VPCs, are virtual networks under your control, if you have managed a regular network
before it should be familiar. VPCs are contained within one region but are spread across multiple availability
zones.
</p>
   <div class="footnotes"><a 
 id="x1-1002x"></a>
<!--l. 25--><p class="indent" >       <span class="footnote-mark"><a 
href="#fn1x0-bk" id="fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
href="https://learn.hashicorp.com/tutorials/terraform/install-cli" class="url" ><span 
class="ectt-1000">https://learn.hashicorp.com/tutorials/terraform/install-cli</span></a></p><a 
 id="x1-13002x10"></a>
<!--l. 421--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn2x0-bk" id="fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance" class="url" ><span 
class="ectt-1000">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance</span></a></p><a 
 id="x1-14002x11"></a>
<!--l. 578--><p class="indent" >   <span class="footnote-mark"><a 
href="#fn3x0-bk" id="fn3x0"><sup class="textsuperscript">3</sup></a></span><span 
class="Cabin-Regular-tlf-t1-">Ingress and egress in networking just means incoming and outgoing respectively.</span></p><a 
 id="x1-14004x11"></a>
<!--l. 583--><p class="indent" >        <span class="footnote-mark"><a 
href="#fn4x0-bk" id="fn4x0"><sup class="textsuperscript">4</sup></a></span><span 
class="Cabin-Regular-tlf-t1-">We do not actually need SSH access as all the server configuration is done when the machine is provisioned, thanks</span>
<span 
class="Cabin-Regular-tlf-t1-">to the </span><span 
class="ectt-1000">user_data</span><span 
class="Cabin-Regular-tlf-t1-">, but we are trying to create a new instance that is identical to the original AWS Console in section</span>
<a 
href="#x1-100007"><span 
class="Cabin-Regular-tlf-t1-">7</span><!--tex4ht:ref: sec:installHextris --></a><span 
class="Cabin-Regular-tlf-t1-">.</span></p>                                                                                                                                                                                                                                      </div>
 
</body></html> 

                                                                                                    


